
<!--#include virtual="/doctype.html" -->
<html>
  <head>
    
    <link href="/css/ooo.css" rel="stylesheet" type="text/css">
    
<title>Service DefaultRegistry</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../../../../idl.css">

    
    <script src="https://www.apachecon.com/event-images/snippet.js"></script>
    <!--#include virtual="/scripts/google-analytics.js" --> 
    <!--#include virtual="/scripts/entourage.js" -->
  </head>
  <body>
    <!--#include virtual="/brand.html" -->
    <div id="topbara">
      <!--#include virtual="/topnav.html" -->
      <div id="breadcrumbsa"><a href="/">home</a>&nbsp;&raquo;&nbsp;<a href="/api/">api</a>&nbsp;&raquo;&nbsp;<a href="/api/docs/">docs</a>&nbsp;&raquo;&nbsp;<a href="/api/docs/common/">common</a>&nbsp;&raquo;&nbsp;<a href="/api/docs/common/ref/">ref</a>&nbsp;&raquo;&nbsp;<a href="/api/docs/common/ref/com/">com</a>&nbsp;&raquo;&nbsp;<a href="/api/docs/common/ref/com/sun/">sun</a>&nbsp;&raquo;&nbsp;<a href="/api/docs/common/ref/com/sun/star/">star</a>&nbsp;&raquo;&nbsp;<a href="/api/docs/common/ref/com/sun/star/registry/">registry</a></div>
    </div>
    <div id="clear"></div>
      <!--#include virtual="/api/leftnav.html" -->
      
    <div id="content">
      
      
<div id="adc-idlref">

<a name="_top_"> </a><table class="navimain" border="0" cellpadding="3">
<tr>
<td class="navimain"><a href="../module-ix.html" class="navimain">Overview</a></td>
<td class="navimain"><a href="module-ix.html" class="navimain">Module</a></td>
<td class="navimain"><a href="DefaultRegistry-xref.html" class="navimain">Use</a></td>
<td class="navimainnone">Devguide</td>
<td class="navimain"><a href="../../../../index-files/index-1.html" class="navimain">Index</a></td>
</tr>
</table>
<table class="navisub" border="0" cellpadding="0">
<tr>
<td class="navisub">Services' Summary</td>
<td class="navisub"><a href="#InterfacesSummary" class="navisub">Interfaces' Summary</a></td>
<td class="navisub">Properties' Summary</td>
<td class="navisub">Services' Details</td>
<td class="navisub"><a href="#InterfacesDetails" class="navisub">Interfaces' Details</a></td>
<td class="navisub">Properties' Details</td>
</tr>
</table>
<hr>
<table border="0" width="100%" cellpadding="5" cellspacing="3" class="title-table" style="margin-bottom:6pt;">
<tr>
<td><p class="namechain"><a href="../../../../module-ix.html" class="namechain">::</a> <a href="../../../module-ix.html" class="namechain">com</a> :: <a href="../../module-ix.html" class="namechain">sun</a> :: <a href="../module-ix.html" class="namechain">star</a> :: <a href="module-ix.html" class="namechain">registry</a> :: </p>
</td>
</tr>
<tr>
<td class="title">service DefaultRegistry</td>
</tr>
<tr>
<td><dl>
<dt><b>Description</b></dt>
<dd>implicitly supports a local registry and a read-only 
 system registry for global information. 
 In the context of this service, 
 the functions <code>open</code>, <code>close</code>, and <code>destroy</code> 
 from <a href="XSimpleRegistry.html">XSimpleRegistry</a> are not supported and throw an exception 
 if they are used. 
 </dd>
<dd><dl>
 <dt>Functions of <a href="XSimpleRegistry.html">XSimpleRegistry</a>:
 <dl>
 <dt> <b>getURL</b>
 </dt>
 <dd> returns the name of the local registry.
 </dd>
 <dt> <b>isValid</b> 
 </dt>
 <dd> checks if the local registry is valid. If the interface is not <b>NULL</b>
 the local registry should always be valid. 
 </dd>
 <dt> <b>isReadOnly</b> </dt>
 <dd> checks if the local registry has write protection.
 </dd>
 <dt> <b>mergeKey</b> 
 </dt>
 <dd> merges all information from the specified registry in the local registry.
 </dd>
 <dt> <b>getRootKey</b> 
 </dt>
 <dd> returns a virtual rootkey of both registries.
 </dd>
 </dl> 
 
 <br>
 
 </dt>
 <dt>Functions of XRegistryKey:
 <dl>
 <dt> <b>openKey</b> 
 </dt>
 <dd> returns a virtual key which is specified in the local or the sytem
 registry.
 </dd>
 <dt> <b>deleteKey</b> 
 </dt>
 <dd> deletes the key only if it is present in the local registry.
 </dd>
 <dt> <b>setLongValue, setAsciiValue, setStringValue, setBinaryValue</b> 
 </dt>
 <dd> sets the value at the specified key in the local registry.
 </dd>
 <dt> <b>getLongValue, getAsciiValue, getStringValue, getBinaryValue</b> 
 </dt>
 <dd> returns the value at the specified key in the local registry, or if 
 the value is not present in the local registry, it will return the value of the
 system registry.
 </dd>
 <dt> <b>openKeys</b> 
 </dt>
 <dd> returns a sequence of all subkeys in both registries.
 </dd>
 <dt> <b>getKeyNames</b> 
 </dt>
 <dd> returns a sequence with the names of all subkeys in both registries.
 </dd>
 <dt>
 <br>
 <b>Note: all write functions only work on the local registry.</b>
 </dt>
 </dl>
 
 <br>
 
 </dt>
 <dt>How to find the registries:
 <dl>
 <dt> search for the system registry:
 </dt>
 <dd> The system registry will always be searched in the same directory as the
 executable. The name of the system registry is "applicat.rdb". If the system 
 registry was not found, then the environment variable STAR_REGISTRY will be checked.
 If this variable was set, it must contain a full path to a valid system registry.
 </dd>
 <dt> Search for the user registry using the following rules:
 </dt>
 <dd>
 <dl>
 <dt> 1. (for further use) search in sversion.ini (.sversionrc) for an entry
 REGISTRY_VERSION_STRING (example: UserRegistry 5.0/505=test.rdb) in the section 
 [Registry]. If found, then take this value instead of "user.rdb" as "REGISTRY NAME".
 </dt>
 <dt> 2. Search in the config directory of the user for a file "REGISTRY NAME". If 
 found, return the full path and name of the file. If not found, retry this 
 step with a dot before "REGISTRY NAME".
 </dt>
 <dt> 3. If not found, a new user registry with name user.rdb will be created in the user 
 config directory. 
 </dt>
 </dl>
 </dd>
 </dl>
 </dt>
 </dl>
 <h4>Guarantees:</h4>
 
 <ul>
 <li>-thread safe</li>
 </ul>
 </dd>
</dl>
</td>
</tr>
</table>
<hr>
<a name="InterfacesSummary"/><table border="1" width="100%" cellpadding="5" cellspacing="0" class="subtitle">
<tr>
<td class="subtitle" colspan="2">Exported Interfaces - Summary</td>
</tr>
<tr>
<td class="imsum_left"><a href="XSimpleRegistry.html">XSimpleRegistry</a></td>
<td class="imsum_right"><dl>
<dt>(referenced entity's summary:)</dt>
<dd>allows access to a registry (a persistent data source).
 The data is stored in a hierarchical key structure beginning with a root key.
 Each key can store a value and can have multiple subkeys.

 </dd>
</dl>
</td>
</tr>
</table>
<a name="InterfacesDetails"/><table border="1" width="100%" cellpadding="5" cellspacing="0" class="subtitle">
<tr>
<td class="subtitle" colspan="2">Exported Interfaces - Details</td>
</tr>
<tr/>
<tr>
<td class="imdetail"><a name="XSimpleRegistry" class="membertitle"><a href="XSimpleRegistry.html">XSimpleRegistry</a></a><table border="0" width="96%" cellpadding="5" cellspacing="0" class="table-in-data" bgcolor="#ffffff" align="center">
<tr>
<td><dl>
<dt>(referenced entity's summary:)</dt>
<dd>allows access to a registry (a persistent data source).
 The data is stored in a hierarchical key structure beginning with a root key.
 Each key can store a value and can have multiple subkeys.

 </dd>
</dl>
</td>
</tr>
</table>
</td>
</tr>
</table>
<br>&nbsp;<a href="#_top_">Top of Page</a><hr size="3"><p class="copyright" align="center">Copyright &copy; 2013, The Apache Software Foundation, Licensed under the Apache License, Version 2.0. Apache, the Apache feather logo, Apache OpenOffice and OpenOffice.org are trademarks of The Apache Software Foundation. Other names may be trademarks of their respective owners.</p>

</div> <!-- id="adc-idlref" -->

      
    </div>
    <!--#include virtual="/footer.html" -->
  </body>
</html>
