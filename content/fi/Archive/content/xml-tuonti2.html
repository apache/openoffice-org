
<!--#include virtual="/doctype.html" -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <link href="/css/ooo.css" rel="stylesheet" type="text/css">
    
<title>Suomenkielinen OpenOffice.org</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="version" content="0.1" />

<!-- Begin Finnish header -->
<style type="text/css" media="screen, projection">
/*<![CDATA[*/
<!--
  @import url(css/fi.css);
-->
/*]]>*/
</style>
<!-- End Finnish header -->

    
    <script src="https://www.apachecon.com/event-images/snippet.js"></script>
  </head>
  <body>
    <!--#include virtual="/fi/brand.html" -->
    <div id="topbara">
      <!--#include virtual="/fi/topnav.html" -->
      <div id="breadcrumbsa"><a href="/">home</a>&nbsp;&raquo;&nbsp;<a href="/fi/">fi</a>&nbsp;&raquo;&nbsp;<a href="/fi/Archive/">Archive</a>&nbsp;&raquo;&nbsp;<a href="/fi/Archive/content/">content</a></div>
    </div>
    <div id="clear"></div>
      
      
    <div id="content">
      
      
<div id="fiheader">
  <div id="fipositioner">
    <a id="fiheader-logo" href="http://fi.openoffice.org/" accesskey="1" title="Suomenkieliselle OpenOffice.org-kotisivulle"></a>
    <h1 id="fipositioner-text">Vapaa ja avoin toimisto-ohjelmisto</h1>

  </div>
</div>
<table id="fibody">
 <tr>
  <td>
   <table width="100%" cellspacing="0" cellpadding="0">
    <tr>
     <td></td>
     <td colspan="2">
      <table cellpadding="5">
       <tr valign="top">
        <td>
        
<!-- Begin Finnish navbar -->
         <div class="fiLeftMenu">
          <div class="toolgroup">
           <div class="label"><strong>OpenOffice.org&nbsp;suomeksi</strong></div>
           <ul>  
            <li><a href="index.html">Pääsivu</a></li>
            <li><a href="lataa.html">Lataa</a></li>
            <li><a href="tuote.html">Ohjelmiston&nbsp;kuvaus</a></li>
            <li><a href="sivukartta.html">Sivukartta</a></li>
           </ul>
          </div>
          
          <div class="toolgroup">
           <div class="label"><strong>Ohjeita</strong></div>
           <ul>
            <li><a href="tuki.html">Käyttäjätuki</a></li>
            <li><a href="vastauksia.html">Vastauksia kysymyksiin</a></li>
            <li><a href="dokumentaatio.html">Käyttöoppaat</a></li>
            <li><a href="kielityokalut.html">Tavutus ja oikoluku</a></li>
            <li><a href="mallit.html">Asiakirjamalleja</a></li>
           </ul>
          </div>
          
          <div class="toolgroup">
           <div class="label"><strong>Suomennosprojekti</strong></div>
           <ul>
            <li><a href="http://fi.openoffice.org/servlets/ProjectNewsList">Tiedotteet</a></li>
            <li><a href="postituslistat.html">Postituslistat</a>
             (<a href="http://fi.openoffice.org/servlets/ProjectMailingListList">engl</a>)
            </li>
            <li><a href="todo.html">Tehtäviä</a></li>
            <li><a href="issuezilla.html">Viat ja toiveet</a>
             (<a href="http://fi.openoffice.org/servlets/ProjectIssues">engl</a>)
            </li>
            <li><a href="yhteystiedot.html">Yhteystiedot</a></li>
           </ul>
          </div> 
         </div>
<!-- End Finnish navbar -->
        </td>
        <td class="pagecontent">
<!-- END-FINNISH-HEADER-PART -->
        
<!-- ====================================================================== -->
<font size="-1"><a href="xml.html">XML-asiakirjat</a> » XML-sanakirjan tuonti</font><br/>

<h1>Esimerkki4 : XML-sanakirja Writer-asiakirjaksi</h1>

<p>Tässä esimerkissä muunnetaan XML-muodossa oleva sanakirja
Writer-asiakirjaksi. Tällöin se voidaan viedä edelleen vaikkapa
PDF:ksi (<a
href="/esimerkit/xml-sanakirja.pdf">xml-sanakirja.pdf</a>).</p>

<h2>XML-asiakirja</h2>

<p>Käytämme esimerkkinä seuraavanlaista XML-muodossa olevaa <a
href="http://lokalisointi.org/sanakirja/">sanakirjaa</a>, joka
esimerkiksi HTML-muotoon muunnettuna näyttää seuraavanlaiselta:</p>

<div style='margin-left: 30px; margin-right: 30px;'>
<table border='1' align='center'><tr><th>Hakusana</th><th>Käännökset</th></tr>
<tr valign='top'><td> <b><a name='e0'>abbreviate</a></b> (v) </td><td>
lyhentää</td></tr>

<tr valign='top'><td> <b><a name='e18'>accessibility</a></b> (s) </td><td>
<font style='font-family: sans-serif; font-variant: small-caps; font-size: 80%%;'>asetukset ja toiminnot, joiden avulla tietokoneen käytöstä tehdään vammaisille helpompaa</font>: esteettömyys (OOo, KDE, Gnome) <sup style='font-size: 50%'>§</sup>, saavutettavuus<sup style='font-size: 50%'>§</sup>, helppokäyttöisyys<sup style='font-size: 50%'>§</sup><br/><font size='-1'>§ Vammaisille tarkoitetuissa palveluissa vakiintunut termi. Ei kuitenkaan ole yleisesti tunnettu.</font><br/><font size='-1'>§§ Vammaisille tarkoitetuissa palveluissa vähemmän suositeltu termi.</font><br/><font size='-1'>§§§ Windowsissa käytetty käännös. Yleisempi ja ymmärrettävämpi kuin oikeampi käännös saavutettavuus.</font></td></tr>

<tr valign='top'><td> <b><a name='e861'>table</a></b> (s) </td><td>
<b>1</b>&nbsp;(<i>tekstinkäsittely, taulukkolaskenta</i>) taulukko,<br/><b>2</b>&nbsp;(<i>tietokanta</i>) taulu</td></tr>
</table>
</div>

<p>Sanat on jaettu ensinnäkin hakusanoihin (headword), joista voi olla
useita sanaluokan (function) mukaisia muotoja. Merkitystasoja on kaksi
(sense, subsense). Sanakirjan rakenteesta on saatavilla myös <a
href="http://lokalisointi.org/sanakirja/rakenne.html">tarkempi kuvaus</a>.</p>

<pre style="font-size: 70%; overflow: scroll; background-color: #f0f0f0; margin-left: 20px; margin-right: 20px;">
&lt;?xml version="1.0" encoding="iso-8859-15" ?&gt;
&lt;dictionary&gt;
  &lt;headword&gt;
    &lt;entry&gt;abbreviate&lt;/entry&gt;
    &lt;function type='verb'&gt;
      &lt;sense id='1'&gt;
        &lt;subsense id='a'&gt;
          &lt;translation id='0'&gt;
            &lt;translated&gt;lyhentää&lt;/translated&gt;
          &lt;/translation&gt;
        &lt;/subsense&gt;
      &lt;/sense&gt;
    &lt;/function&gt;
  &lt;/headword&gt;

  &lt;headword&gt;
    &lt;entry&gt;accessibility&lt;/entry&gt;
    &lt;function type='noun'&gt;
      &lt;sense id='1'&gt;
        &lt;subsense id='a'&gt;
          &lt;definition&gt;asetukset ja toiminnot, joiden avulla tietokoneen käytöstä tehdään vammaisille helpompaa&lt;/definition&gt;
          &lt;usage&gt;OOo, KDE, Gnome&lt;/usage&gt;
          &lt;translation id='0'&gt;
            &lt;translated&gt;esteettömyys&lt;/translated&gt;
            &lt;usage&gt;OOo, KDE, Gnome&lt;/usage&gt;
            &lt;noteref id='1'/&gt;
          &lt;/translation&gt;
          &lt;translation id='1'&gt;
            &lt;translated&gt;saavutettavuus&lt;/translated&gt;
            &lt;noteref id='1'/&gt;
          &lt;/translation&gt;
          &lt;translation id='2'&gt;
            &lt;translated&gt;helppokäyttöisyys&lt;/translated&gt;
            &lt;noteref id='1'/&gt;
          &lt;/translation&gt;
        &lt;/subsense&gt;
      &lt;/sense&gt;
      &lt;notes&gt;
      &lt;note id='1'&gt;Vammaisille tarkoitetuissa palveluissa vakiintunut termi. Ei kuitenkaan ole yleisesti tunnettu.&lt;/note&gt;
      &lt;note id='2'&gt;Vammaisille tarkoitetuissa palveluissa vähemmän suositeltu termi.&lt;/note&gt;
      &lt;note id='3'&gt;Windowsissa käytetty käännös. Yleisempi ja ymmärrettävämpi kuin oikeampi käännös saavutettavuus.&lt;/note&gt;
      &lt;/notes&gt;
    &lt;/function&gt;
  &lt;/headword&gt;
...
  &lt;headword&gt;
    &lt;entry&gt;table&lt;/entry&gt;
    &lt;function type='noun'&gt;
      &lt;sense id='1'&gt;
        &lt;subsense id='a'&gt;
          &lt;context&gt;tekstinkäsittely, taulukkolaskenta&lt;/context&gt;
          &lt;translation id='0'&gt;
            &lt;translated&gt;taulukko&lt;/translated&gt;
          &lt;/translation&gt;
        &lt;/subsense&gt;
      &lt;/sense&gt;
      &lt;sense id='2'&gt;
        &lt;subsense id='a'&gt;
          &lt;context&gt;tietokanta&lt;/context&gt;
          &lt;translation id='0'&gt;
            &lt;translated&gt;taulu&lt;/translated&gt;
          &lt;/translation&gt;
        &lt;/subsense&gt;
      &lt;/sense&gt;
    &lt;/function&gt;
  &lt;/headword&gt;
...
&lt;/dictionary&gt;
</pre>

<h2>XSLT-muunnin</h2>

<p>XSLT-tuontisuodatin muuntaa tuotavan XML-asiakirjan
OpenOffice.org-asiakirjan <tt>content.xml</tt>-tiedostoksi. Alla oleva
muunnos muuntaa XML-muotoisen sanakirjan OpenOffice.org 1.1 Writer
-asiakirjaksi.</p>

<p>Muunnos koostuu kahdesta pääosasta:</p>

<ul>
  <li>asiakirjan rungon määrittelystä ja</li>
  <li>eri tyyppisten elementtien muunnoksista.</li>
</ul>

<p>Rungon määrittelyssä määritellään muun muassa useapalstaisen osan
tyyli. Muunnoksen loppuosa koostuu erilaisten alirakenteiden
muunnoksista.</p>

<pre style="font-size: 70%; overflow: scroll; background-color: #f0f0f0; margin-left: 20px; margin-right: 20px;">
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:office="http://openoffice.org/2000/office"
  xmlns:style="http://openoffice.org/2000/style"
  xmlns:text="http://openoffice.org/2000/text"
  xmlns:fo="http://www.w3.org/1999/XSL/Format"
  office:class="text"
  office:version="1.0"
  version="1.0"&gt;

  &lt;xsl:output indent="yes" encoding="UTF-8"/&gt;

  &lt;!-- ============================================================================ --&gt;
  &lt;!-- Asiakirjan runko.                                                            --&gt;
  &lt;!-- ============================================================================ --&gt;
  &lt;xsl:template match="/"&gt;
    &lt;office:document&gt;

      &lt;office:automatic-styles&gt;
        &lt;!-- Osatyyli --&gt;
        &lt;style:style style:name="Sect1" style:family="section"&gt;
          &lt;style:properties text:dont-balance-text-columns="false"&gt;
            &lt;style:columns fo:column-count="3" fo:column-gap="0.198cm"&gt;
              &lt;style:column style:rel-width="3193*" fo:margin-left="0cm" fo:margin-right="0.099cm"/&gt;
              &lt;style:column style:rel-width="3250*" fo:margin-left="0.099cm" fo:margin-right="0.099cm"/&gt;
              &lt;style:column style:rel-width="3194*" fo:margin-left="0.099cm" fo:margin-right="0cm"/&gt;
            &lt;/style:columns&gt;
          &lt;/style:properties&gt;
        &lt;/style:style&gt;
      &lt;/office:automatic-styles&gt;

      &lt;office:body&gt;

        &lt;!-- Otsikko --&gt;
        &lt;text:h text:level="1" text:style-name="Heading 1"&gt;
          &lt;xsl:text&gt;Sanakirja&lt;/xsl:text&gt;
        &lt;/text:h&gt;

        &lt;!-- Esittelyteksti --&gt;
        &lt;text:p text:style-name="Text body"&gt;
          &lt;xsl:text&gt;Tämä on omassa XML-formaatissa olevasta
          sanakirjasta tuotu Writer-asiakirja.&lt;/xsl:text&gt;
        &lt;/text:p&gt;

        &lt;!-- Rekursio --&gt;
        &lt;text:section text:style-name="Sect1" text:name="Osa1"&gt;
          &lt;xsl:apply-templates select="dictionary/headword/function"/&gt;
        &lt;/text:section&gt;

        &lt;text:p text:style-name="Text body"&gt;&lt;/text:p&gt;
        &lt;text:p text:style-name="Text body"&gt;
          &lt;xsl:text&gt;Marko Grönroos, 2003-2005. Kopiointi ja
          tulostaminen sallittu henkilökohtaiseen käyttöön.&lt;/xsl:text&gt;
        &lt;/text:p&gt;

      &lt;/office:body&gt;
    &lt;/office:document&gt;
  &lt;/xsl:template&gt;

  &lt;!-- ============================================================================ --&gt;
  &lt;!-- Yhden hakusanan tiedot                                                       --&gt;
  &lt;!-- ============================================================================ --&gt;
  &lt;xsl:template match="headword/function"&gt;
    &lt;text:p text:style-name="Sana"&gt;
      
      &lt;!-- Hakusana --&gt;
      &lt;text:span text:style-name="Hakusana"&gt;
        &lt;xsl:value-of select="../entry"/&gt;
      &lt;/text:span&gt;
      &lt;xsl:text&gt; &lt;/xsl:text&gt;
      &lt;text:span text:style-name="Sanaluokka"&gt;
        &lt;xsl:choose&gt;
          &lt;xsl:when test="@type = 'verb'"&gt;&lt;xsl:text&gt;v&lt;/xsl:text&gt;&lt;/xsl:when&gt;
          &lt;xsl:when test="@type = 'noun'"&gt;&lt;xsl:text&gt;s&lt;/xsl:text&gt;&lt;/xsl:when&gt;
          &lt;xsl:when test="@type = 'adj'"&gt;&lt;xsl:text&gt;a&lt;/xsl:text&gt;&lt;/xsl:when&gt;
        &lt;/xsl:choose&gt;
      &lt;/text:span&gt;
      &lt;xsl:text&gt; &lt;/xsl:text&gt;

      &lt;xsl:apply-templates select="sense"/&gt;
      &lt;xsl:apply-templates select="notes"/&gt;
    &lt;/text:p&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match="sense"&gt;
    &lt;text:span text:style-name="Merkitys"&gt;
      &lt;xsl:value-of select="@id"/&gt;
      &lt;xsl:text&gt; &lt;/xsl:text&gt;
    &lt;/text:span&gt;

    &lt;xsl:apply-templates select="subsense"/&gt;
  &lt;/xsl:template&gt;
  
  &lt;xsl:template match="subsense"&gt;
    &lt;xsl:if test="count(../subsense) &gt; 1"&gt;
      &lt;text:span text:style-name="Alamerkitys"&gt;
        &lt;xsl:value-of select="@id"/&gt;
        &lt;xsl:text&gt; &lt;/xsl:text&gt;
      &lt;/text:span&gt;
    &lt;/xsl:if&gt;

    &lt;xsl:apply-templates select="context"/&gt;
    &lt;xsl:apply-templates select="definition"/&gt;
    &lt;xsl:apply-templates select="translation"/&gt;
  &lt;/xsl:template&gt;
  
  &lt;xsl:template match="context|usage"&gt;
    &lt;xsl:text&gt; (&lt;/xsl:text&gt;
    &lt;text:span text:style-name="Default"&gt;
      &lt;xsl:value-of select="."/&gt;
    &lt;/text:span&gt;
    &lt;xsl:text&gt;) &lt;/xsl:text&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match="definition"&gt;
    &lt;xsl:text&gt; &lt;/xsl:text&gt;
    &lt;text:span text:style-name="Default"&gt;
      &lt;xsl:value-of select="."/&gt;
    &lt;/text:span&gt;
    &lt;xsl:text&gt;. &lt;/xsl:text&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match="definition"&gt;
    &lt;xsl:text&gt; &lt;/xsl:text&gt;
    &lt;text:span text:style-name="Default"&gt;
      &lt;xsl:value-of select="."/&gt;
    &lt;/text:span&gt;
    &lt;xsl:text&gt;; &lt;/xsl:text&gt;
  &lt;/xsl:template&gt;

  &lt;!-- ============================================================================ --&gt;
  &lt;!-- Käännökset (translation)                                                     --&gt;
  &lt;!-- ============================================================================ --&gt;
  &lt;xsl:template match="translation"&gt;
    &lt;xsl:apply-templates select="context"/&gt;
    &lt;xsl:apply-templates select="usage"/&gt;
    &lt;xsl:apply-templates select="translated"/&gt;
    &lt;xsl:apply-templates select="ref"/&gt;

    &lt;xsl:if test="position()!=last()"&gt;
      &lt;xsl:text&gt;, &lt;/xsl:text&gt;
    &lt;/xsl:if&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match="translated"&gt;
    &lt;xsl:text&gt; &lt;/xsl:text&gt;
    &lt;text:span text:style-name="Default"&gt;
      &lt;xsl:value-of select="."/&gt;
    &lt;/text:span&gt;

    &lt;xsl:if test="position()!=last()"&gt;
      &lt;xsl:text&gt;, &lt;/xsl:text&gt;
    &lt;/xsl:if&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match="ref"&gt;
    &lt;xsl:text&gt;; ks. &lt;/xsl:text&gt;
    &lt;text:span text:style-name="Viittaus"&gt;
      &lt;xsl:value-of select="."/&gt;
    &lt;/text:span&gt;
  &lt;/xsl:template&gt;

  &lt;!-- ============================================================================ --&gt;
  &lt;!-- Huomautukset (notes)                                                         --&gt;
  &lt;!-- ============================================================================ --&gt;
  &lt;xsl:template match="notes"&gt;
    &lt;xsl:if test="count(note) &gt; 0"&gt;
      &lt;text:span text:style-name="Huomautusotsikko"&gt;
        &lt;xsl:text&gt; Huomautuksia: &lt;/xsl:text&gt;
      &lt;/text:span&gt;
      &lt;xsl:apply-templates select="note"/&gt;
    &lt;/xsl:if&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match="note"&gt;
    &lt;text:span text:style-name="Huomautusmerkki"&gt;
      &lt;xsl:value-of select="substring('§§§§§§§§§', 1, number(@id))"/&gt;
    &lt;/text:span&gt;
    &lt;xsl:text&gt; &lt;/xsl:text&gt;
    &lt;text:span text:style-name="Huomautus"&gt;
      &lt;xsl:value-of select="."/&gt;
    &lt;/text:span&gt;
    &lt;xsl:if test="position()!=last()"&gt;
      &lt;xsl:text&gt;, &lt;/xsl:text&gt;
    &lt;/xsl:if&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</pre>

<h2>Tuontisuodattimen malliasiakirja</h2>

<p>Malliasiakirjassa (<a
href="/esimerkit/sanakirja-malli.stw">sanakirja-malli.stw</a>) on määritelty sanakirjan vaatimat kappale- ja
merkkityylit. Esimerkiksi <tt>headword</tt>-elementti sisältö
muunnetaan <tt>Sana</tt>-tyyliseksi kappaleeksi ja sen alaelementit
merkkityyleiksi. Esimerkiksi <tt>entry</tt>-elementissä annettava
hakusanan nimi muunnetaan <tt>Hakusana</tt>-merkkityyliseksi. </p>

<div align="center"><img src="kaappaukset/kaappaus_xml_sanakirja-1.png"></div>

<p>Malliasiakirjan sisällöllä ei ole mitään merkitystä ja se
poistetaan tuotaessa. Sitä voi kuitenkin käyttää tyylejä
suunniteltaessa esimerkkinä.</p>

<h2>Tuontisuodattimen käyttö</h2>

<p>Tuonti voidaan tehdä OpenOffice.orgin sisällä <a href="suodatin.html">asentamalla
XSLT-muunnin suodattimeksi</a> tai ulkopuolella erillisellä
XSLT-käsittelijällä.</p>

<p>Alla on esitetty tuontisuodattimen avulla tuotu asiakirja:</p>

<div align="center"><img src="kaappaukset/kaappaus_xml_sanakirja-2.png"></div>

<p>Asiakirja on nyt helposti vietävissä vaikkapa PDF-formaattiin:</p>

<ul>
  <li><a href="/esimerkit/xml-sanakirja.pdf">xml-sanakirja.pdf</a>
</ul>

<p style="margin-top: 5em;">Marko Grönroos<br>magi42@openoffice.org</p>

<!-- ====================================================================== -->
        </td>
       </tr>
      </table>
     </td>
    </tr>
   </table>
  </td>
 </tr>
</table>


      
    </div>
    <!--#include virtual="/footer.html" -->
  </body>
</html>
