
<!--#include virtual="/doctype.html" -->
<html>
  <head>
    
    <link href="/css/ooo.css" rel="stylesheet" type="text/css">
    
<title>Suomenkielinen OpenOffice.org</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="version" content="0.1" />

<!-- Begin Finnish header -->
<style type="text/css" media="screen, projection">
/*<![CDATA[*/
<!--
  @import url(css/fi.css);
-->
/*]]>*/
</style>
<!-- End Finnish header -->

    
    <!--#include virtual="/scripts/google-analytics.js" --> 
    <!--#include virtual="/scripts/entourage.js" -->
  </head>
  <body>
    <!--#include virtual="/fi/brand.html" -->
    <div id="topbara">
      <!--#include virtual="/fi/topnav.html" -->
      <div id="breadcrumbsa"><a href="/">home</a>&nbsp;&raquo;&nbsp;<a href="/fi/">fi</a>&nbsp;&raquo;&nbsp;<a href="/fi/Archive/">Archive</a></div>
    </div>
    <div id="clear"></div>
      
      
    <div id="content">
      
      
<div id="fiheader">
	<div id="fipositioner">
		<a id="fiheader-logo" href="http://fi.openoffice.org/" accesskey="1" title="Suomenkieliselle OpenOffice.org-kotisivulle"></a>
		<h1 id="fipositioner-text">Vapaa ja avoin toimisto-ohjelmisto</h1>

	</div>
</div>
<table id="fibody">
 <tr>
  <td>
   <table width="100%" cellspacing="0" cellpadding="0">
    <tr>
     <td></td>
     <td colspan="2">
      <table cellpadding="5">
       <tr valign="top">
        <td>
        
<!-- Begin Finnish navbar -->
         <div class="fiLeftMenu">
          <div class="toolgroup">
           <div class="label"><strong>OpenOffice.org&nbsp;suomeksi</strong></div>
           <ul>  
            <li><a href="index.html">Pääsivu</a></li>
            <li><a href="lataa.html">Lataa</a></li>
            <li><a href="tuote.html">Ohjelmiston&nbsp;kuvaus</a></li>
            <li><a href="sivukartta.html">Sivukartta</a></li>
           </ul>
          </div>
          
          <div class="toolgroup">
           <div class="label"><strong>Ohjeita</strong></div>
           <ul>
            <li><a href="tuki.html">Käyttäjätuki</a></li>
            <li><a href="vastauksia.html">Vastauksia kysymyksiin</a></li>
            <li><a href="dokumentaatio.html">Käyttöoppaat</a></li>
            <li><a href="kielityokalut.html">Tavutus ja oikoluku</a></li>
            <li><a href="mallit.html">Asiakirjamalleja</a></li>
           </ul>
          </div>
          
          <div class="toolgroup">
           <div class="label"><strong>Suomennosprojekti</strong></div>
           <ul>
            <li><a href="http://fi.openoffice.org/servlets/ProjectNewsList">Tiedotteet</a></li>
            <li><a href="postituslistat.html">Postituslistat</a>
             (<a href="http://fi.openoffice.org/servlets/ProjectMailingListList">engl</a>)
            </li>
            <li><a href="todo.html">Tehtäviä</a></li>
            <li><a href="issuezilla.html">Viat ja toiveet</a>
             (<a href="http://fi.openoffice.org/servlets/ProjectIssues">engl</a>)
            </li>
            <li><a href="yhteystiedot.html">Yhteystiedot</a></li>
           </ul>
          </div> 
         </div>
<!-- End Finnish navbar -->
        </td>
        <td class="pagecontent">
<!-- END-FINNISH-HEADER-PART -->
        
<!-- ====================================================================== -->
<font size="-1"><a href="xml.html">XML-asiakirjat</a> » Johdanto</font><br/>

<h1>OpenOffice.orgin XML-tiedostomuoto</h1>

<p>Sekä vanha OpenOffice.org 1.1.x että uusi OpenOffice.org 2.0
käyttävät samankaltaista XML-pohjaista tiedostomuotoa. Uusi OASIS
OpenDocument -tiedostomuoto on kansainvälisen
OASIS-standardisointikonsortion kehittämä avoin dokumenttistandardi,
joka pohjautuu vahvasti OpenOffice.org 1.1.x:n tiedostomuotoon.</p>

<h2>Asiakirjapaketin sisältö</h2>

<p>OpenDocument-asiakirjat ovat todellisuudessa pakattuja
Zip-paketteja, jotka sisältävät useita tiedostoja. Kaikki asiakirjan sisältämät grafiikat ja muut
erikoisobjektit on tallennettu paketissa erilliseen alikansioon.</p>

<p>Asiakirjapaketin tärkeimmät tiedostot ja kansiot ovat:</p>

<table bgcolor="#e0e0ff" align="center">
<tr>
  <th align="left">Tiedosto/Kansio</th>
  <th align="left">Kuvaus</th>
</tr>
<tr>
  <td><tt>mimetype</tt></td>
  <td>Asiakirjan tiedostomuodon MIME-tyyppi.</td>
</tr>
<tr>
  <td><tt>content.xml</tt></td>
  <td>Asiakirjan varsinainen sisältö.</td>
</tr>
<tr>
  <td><tt>styles.xml</tt></td>
  <td>Asiakirjan tyylit.</td>
</tr>
<tr>
  <td><tt>meta.xml</tt></td>
  <td>Asiakirjan metatiedot, kuten luojan ja viimeisen muokkaajan tiedot.</td>
</tr>
<tr>
  <td><tt>settings.xml</tt></td>
  <td>Asiakirjakohtaiset asetukset.</td>
</tr>
<tr>
  <td><tt>Pictures/</tt></td>
  <td>Asiakirjan kuvat sisältävä kansio.</td>
</tr>
</table>

<p>Huomaa, että vaikka tyylit on määritelty
<tt>styles.xml</tt>-tiedostossa, myös <tt>content.xml</tt>-tiedostossa on
tyylimäärittelyjä. Styles-tiedostossa on myös jonkin verran asiakirjan
sisältöä, kuten ylä- ja alatunnisteet.</p>

<p>Oleellisin tiedostoista on <tt>content.xml</tt>, joka sisältää
asiakirjan varsinaisen sisällön. Sen rakenne on suurinpiirtein
seuraavanlainen:</p>

<pre style="background-color: #fff0f0; margin-left: 20px; margin-right: 20px; margin-bottom: 0;">
&lt;office:document-content&gt;
  &lt;office:font-face-decls&gt;
    <i>...fonttimäärittelyjä...</i>
  &lt;/office:font-face-decls&gt;
  &lt;office:automatic-styles&gt;
    <i>...tyylimäärittelyjä...</i>
  &lt;/office:automatic-styles&gt;
</pre>
<pre style="background-color: #f0f0ff; margin-left: 20px; margin-right: 20px; margin-top: 0;">
  &lt;office:body&gt;
    &lt;office:text&gt;
      <i>...asiakirjan teksti ja rakennesisältö...</i>
    &lt;/office:text&gt;
  &lt;/office:body&gt;
&lt;/office:document-content&gt;
</pre>

<p>Tässä on esitetty tekstiasiakirjan yleisrakenne, muilla
asiakirjoilla se on vastaava.</p>

<h2>Asiakirjan käsittely XSLT:llä</h2>

<p>Asiakirjojen muuntaminen toiseen muotoon tapahtuu helpoiten
XSLT-kielellä, joskin muitakin ohjelmointikieliä ja -työkaluja voi
käyttää.</p>

<p>XSLT-kielellä tehdyt muuntimet on mahdollista <a
href="xml-suodatin.html">asentaa</a> OpenOffice.orgiin suodattimiksi.</p>

<p>Tämä ohje ei syvenny XSLT-kielen käyttöön. Ainoa mainittava asia on
nimiavaruusmäärittelyt, jotka täytyy tehdä XSLT-ohjelman alussa:</p>

<h3>Nimiavaruusmäärittelyt</h3>

<p>XSLT-ohjelmassa täytyy tehdä nimiavaruusmäärittelyt niiden
XML-koodien osalta, joita ohjelmassa käsitellään.</p>

<p>OpenOffice.org 1.1:n asiakirjojen vaatimat määrittelyt ovat
seuraavanlaiset:</p>

<pre style="font-size: 70%; background-color: #f0f0f0; margin-left: 20px; margin-right: 20px;">
&lt;?xml version="1.0"?&gt;
&lt;xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:office="http://openoffice.org/2000/office"
  xmlns:style="http://openoffice.org/2000/style"
  xmlns:text="http://openoffice.org/2000/text"
  xmlns:table="http://openoffice.org/2000/table"
  xmlns:draw="http://openoffice.org/2000/drawing"
  xmlns:fo="http://www.w3.org/1999/XSL/Format"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:number="http://openoffice.org/2000/datastyle"
  xmlns:svg="http://www.w3.org/2000/svg"
  xmlns:chart="http://openoffice.org/2000/chart"
  xmlns:dr3d="http://openoffice.org/2000/dr3d"
  xmlns:math="http://www.w3.org/1998/Math/MathML"
  xmlns:form="http://openoffice.org/2000/form"
  xmlns:script="http://openoffice.org/2000/script"
  office:class="text"
  office:version="1.0"
  version="1.0"&gt;

  &lt;!-- ... XSLT-ohjelman sisältö tulee tähän ... --&gt;

&lt;/xsl:stylesheet&gt;
</pre>

<p>OpenOffice.org 2.0:n käyttämän OASIS OpenDocument -tiedostomuodon
vaatimat määrittelyt ovat seuraavanlaiset:</p>

<pre style="font-size: 70%; background-color: #f0f0f0; margin-left: 20px; margin-right: 20px;">
&lt;?xml version="1.0"?&gt;
&lt;xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0"
  xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0"
  xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0"
  xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0"
  xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"
  xmlns:fo="http://www.w3.org/1999/XSL/Format"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0"
  xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"
  xmlns:svg="http://www.w3.org/2000/svg"
  xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0"
  xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"
  xmlns:math="http://www.w3.org/1998/Math/MathML"
  xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0"
  xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0"
  xmlns:ooo="http://openoffice.org/2004/office"
  xmlns:ooow="http://openoffice.org/2004/writer"
  xmlns:oooc="http://openoffice.org/2004/calc"
  xmlns:dom="http://www.w3.org/2001/xml-events"
  xmlns:xforms="http://www.w3.org/2002/xforms"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  office:version="1.0"
  version="1.0"&gt;

  &lt;!-- ... XSLT-ohjelman sisältö tulee tähän ... --&gt;

&lt;/xsl:stylesheet&gt;
</pre>

<p>Tässä on lueteltu kaikki nimiavaruusmäärittelyt; niistä kuitenkin
tarvitaan vain ne, joita XSLT-ohjelmassa käytetään.</p>

<h2>Esimerkkejä</h2>

<ul>
  <li><a href="xml-otsikot.html">Esimerkki 1: tekstiasiakirjan otsikkojen listaaminen</a></li>
  <li><a href="xml-lomake1.html">Esimerkki 2: lomakkeen syöttökenttien kerääminen</a></li>
  <li><a href="xml-lomake2.html">Esimerkki 3: ohjausobjektilomakkeen tietojen kerääminen</a></li>
</ul>

<p style="margin-top: 5em;">Marko Grönroos<br>magi42@openoffice.org</p>

<!-- ====================================================================== -->
        </td>
       </tr>
      </table>
     </td>
    </tr>
   </table>
  </td>
 </tr>
</table>


      
    </div>
    <!--#include virtual="/footer.html" -->
  </body>
</html>
