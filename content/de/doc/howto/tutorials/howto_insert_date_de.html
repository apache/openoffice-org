
<!--#include virtual="/doctype.html" -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <link href="/css/ooo.css" rel="stylesheet" type="text/css">
    
<title>Howto: Einf&uuml;gen von Datum/Uhrzeit</title>
<!-- Start de-header -->
<link rel="stylesheet" href="../../../styles/de.css" media="screen" type="text/css" />
<link rel="stylesheet" href="../../../styles/de_print.css" media="print" type="text/css" />
<link rel="stylesheet" title="mit Navbar" href="../../../styles/de_navbar.css" media="screen" type="text/css" />
<link rel="alternate stylesheet" title="ohne Navbar" media="screen" href="../../../styles/de_nonavbar.css" type="text/css" />
<script type="text/javascript" src="styles/de.js"></script >
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- >
 Kommentare zur Seite
 $Id: howto_insert_date_de.html,v 1.5 2004/10/27 18:04:31 louis Exp $
 < -->
<!-- End de-header -->

    
    <script src="https://www.apachecon.com/event-images/snippet.js"></script>
    <!--#include virtual="/scripts/google-analytics.js" --> 
    <!--#include virtual="/scripts/entourage.js" -->
  </head>
  <body>
    <!--#include virtual="/de/brand.html" -->
    <div id="topbara">
      <!--#include virtual="/de/topnav.html" -->
      <div id="breadcrumbsa"><a href="/">home</a>&nbsp;&raquo;&nbsp;<a href="/de/">de</a>&nbsp;&raquo;&nbsp;<a href="/de/doc/">doc</a>&nbsp;&raquo;&nbsp;<a href="/de/doc/howto/">howto</a>&nbsp;&raquo;&nbsp;<a href="/de/doc/howto/tutorials/">tutorials</a></div>
    </div>
    <div id="clear"></div>
      
      
    <div id="content">
      
      
<h2>OpenOffice.org Workshop</h2>
<p><br />
  Wie kann man das aktuelle Datum oder die aktuelle Uhrzeit per Tastatur dauerhaft in ein Text- oder Tabellendokument einf&uuml;gen?</p>
<p>von Daniel Rentz.<br />
  <br />
</p>
<h2>Inhaltsverzeichnis</h2>
<ol>
  <li>
    <p><a href="#aenderungen">&Auml;nderungen</a></p>
  </li>
  <li>
    <p><a href="#copyright">Copyright und Lizenzhinweis</a></p>
    <ul>
      <li>2.1 <a href="#pdl">Public Documentation License Notice</a></li>
      <li>
        <p>2.2 <a href="#produktnamen">Produktnamen und Warenzeichen</a></p>
      </li>
    </ul>
  </li>
  <li>
    <p><a href="#einfuehrung">Einf&uuml;hrung</a></p>
  </li>
  <li>
    <p><a href="#basicmakros">BASIC-Makros</a></p>
    <ul>
      <li>4.1 <a href="#allgemeines">Allgemeines</a></li>
      <li>4.2 <a href="#parameterlose">Parameterlose Makros f&uuml;r Tastaturk&uuml;rzel</a></li>
      <li>4.3 <a href="#hilfsfunktiontext">Hilfsfunktion zum Einf&uuml;gen als Text</a></li>
      <li>4.4 <a href="#hilfsfunktionzahlenformat">Hilfsfunktion zum Setzen eines Zahlenformates</a></li>
      <li>4.5 <a href="#hilfsfunktionwert">Hilfsfunktion zum Einf&uuml;gen als Wert oder Textfeld</a></li>
      <li>
        <p>4.6 <a href="#erlaeuterungen">Erl&auml;uterungen</a></p>
      </li>
    </ul>
  </li>
  <li><a href="#tastaturkuerzel">Tastaturk&uuml;rzel</a></li>
</ol>
<h2><br />
  <br />
  <br />
  1. <a name="aenderungen">&Auml;nderungen</a></h2>
<table width="100%" border="1" cellpadding="4" cellspacing="0">
  <col width="60" />
  <col width="196" />
  <thead>
    <tr valign="top">
      <td width="24%" bgcolor="#e6e6e6"><p>&Auml;nderungen</p></td>
      <td width="76%" bgcolor="#e6e6e6"><p><br />
        </p></td>
    </tr>
  </thead>
  <tbody>
    <tr valign="top">
      <td width="24%"><p>11.02.2003</p></td>
      <td width="76%"><p>Erste Version.</p></td>
    </tr>
    <tr valign="top">
      <td width="24%"><p>28.06.2004</p></td>
      <td width="76%"><p>OOo 1.1 Beta <i>-&gt;</i> OOo 1.1.x</p>
        <p>oController.Formula <i>-&gt;</i> oController.FormulaLocal</p>
        <ol>
          <li>
            <p>Selbstdefinierte Zahlenformate</p>
          </li>
        </ol></td>
    </tr>
    <tr valign="top">
      <td width="24%"><p>13.07.2004</p></td>
      <td width="76%"><p>OOo 2.0 hinzugef&uuml;gt</p>
        <p>Textfelder in Writer einf&uuml;gen</p></td>
    </tr>
    <tr valign="top">
      <td width="24%"><p>14.07.2004</p></td>
      <td width="76%"><p>Lizenzhinweis</p></td>
    </tr>
  </tbody>
</table>
<h2><br />
  <br />
  2. <a name="copyright">Copyright und Lizenzhinweis</a></h2>
<p>&copy; Copyright 2004 Daniel Rentz</p>
<h3><br />
  <br />
  2.1 <a name="pdl">Public Documentation License Notice</a></h3>
<p>The contents of this Documentation are subject to the Public Documentation License Version 1.0 (the &quot;License&quot;); you may only use this Documentation if you comply with the terms of this License. A copy of the License is available at <a href="//licenses/PDL.html">//licenses/PDL.html</a>.</p>
<p>The Original Documentation is &quot;Wie kann man das aktuelle Datum oder die aktuelle Uhrzeit per Tastatur dauerhaft in ein Text- oder Tabellendokument einf&uuml;gen?&quot;.</p>
<p>The Initial Writer of the Original Documentation is Daniel Rentz, Copyright &copy; 2004. All Rights Reserved</p>
<p>Initial Writer contact: <a href="mailto:dr@openoffice.org">dr@openoffice.org</a>.</p>
<p>All Trademarks are properties of their respective owners.</p>
<h3><br />
  <br />
  2.2 <a name="produktnamen">Produktnamen und Warenzeichen</a></h3>
<p>Alle in diesem Dokument erw&auml;hnten Produktnamen und eingetragenen oder nicht eingetragenen Warenzeichen sind nur zum Zweck der Identifizierung erw&auml;hnt und sind das ausschlie&szlig;liche Eigentum ihrer Halter.</p>
<h2><br />
  <br />
  3. <a name="einfuehrung">Einf&uuml;hrung</a></h2>
<p>Was in MS Word von vornherein mit Alt+Umschalt+D oder Alt+Umschalt+T bzw. in MS Excel mit Strg+Punkt oder Strg+Umschalt+Punkt funktioniert, erfordert in Calc oder Writer anf&auml;nglich etwas Arbeit. Daf&uuml;r ist die nun folgende L&ouml;sung flexibler und funktioniert identisch in Text- und Tabellendokumenten.</p>
<p>Diese Anleitung ist f&uuml;r OpenOffice.org&nbsp;1.0.x, OpenOffice.org&nbsp;1.1.x und OpenOffice.org&nbsp;2.0 geschrieben. Wenn es Unterschiede wie z.B. in der Men&uuml;struktur gibt, werden diese mit [1.0], [1.1] bzw. [2.0] gekennzeichnet.</p>
<h2><br />
  <br />
  4. <a name="basicmakros">BASIC-Makros</a></h2>
<h3>4.1 <a name="allgemeines">Allgemeines</a></h3>
<p>Um eine neue Funktionalit&auml;t an eine Tastenkombination zu binden, ben&ouml;tigen Sie zuerst ein BASIC-Makro. Das Makro speichern Sie im Standard-Modul von OpenOffice.org, damit es unabh&auml;ngig von ge&ouml;ffneten Dokumenten verf&uuml;gbar ist.</p>
<p>In einem Tabellendokument wird es zwei M&ouml;glichkeiten geben, ein Datum bzw. eine Zeit einzuf&uuml;gen:</p>
<ol>
  <li>als Wertezelle, d.h. mit dem Datum bzw. der Zeit kann in Formeln weitergerechnet werden,</li>
  <li>als Textzelle.</li>
</ol>
<p>Dabei wird die Zelle &uuml;berschrieben, auf die der Cursor gerade zeigt.</p>
<p>In einemTextdokument wird es ebenfalls zwei M&ouml;glichkeiten geben, ein Datum bzw. eine Zeit einzuf&uuml;gen:</p>
<ol>
  <li>als Textfeld,</li>
  <li>als einfacher Text.</li>
</ol>
<p>Dabei wird an der aktuellen Cursorposition eingef&uuml;gt bzw. ein vorher ausgew&auml;hlter Text ersetzt.</p>
<p>Ein neues BASIC-Makro legen Sie im Dialog <i>Extras-&gt;Makro... </i>[1.0], <i>Extras-&gt;Makros-&gt;Makro... </i>[1.1] bzw. <i>Extras-&gt;Makros-&gt;Makros verwalten-&gt;OpenOffice.org Basic </i>[2.0] an. Im Listenfeld <i>Makro aus</i> sollte schon das Standard-Modul (<i>soffice-&gt;Standard-&gt;Module1</i>) ausgew&auml;hlt sein. Mit der Schaltfl&auml;che <i>Bearbeiten</i> gelangen Sie in den Quelltext-Editor.</p>
<h3><br />
  <br />
  4.2 <a name="parameterlose">Parameterlose Makros f&uuml;r Tastaturk&uuml;rzel</a></h3>
<pre>Sub Insert_Date_As_Text
 Insert_As_Text( Date )
End Sub

Sub Insert_Date_As_Value
 Insert_As_Value( Date, &quot;TT. MMM JJJJ&quot;, com.sun.star.util.NumberFormat.DATE )
End Sub

Sub Insert_Time_As_Text
 Insert_As_Text( Time )
End Sub

Sub Insert_Time_As_Value
 Insert_As_Value( Time, &quot;HH:MM:SS&quot;, com.sun.star.util.NumberFormat.TIME )
End Sub</pre>
<h3><br />
  <br />
  4.3 <a name="hilfsfunktiontext">Hilfsfunktion zum Einf&uuml;gen als Text</a></h3>
<pre><font color="#808080"><i>'-------------------------------------------------
' Inserts the passed string into a document.
'
' parameter aValue
' The string to be inserted into the document.
'-------------------------------------------------</i></font>

Sub Insert_As_Text( aValue As String )

 oDesktop = createUnoService( &quot;com.sun.star.frame.Desktop&quot; )
 oController = oDesktop.CurrentFrame.Controller
 oDocument = oController.Model

<font color="#808080"><i> ' insert as text for Calc ----------------------</i></font>
 If oDocument.supportsService( &quot;com.sun.star.sheet.SpreadsheetDocument&quot; ) Then
 oSelection = oController.Selection
 oSelection.Formula = &quot;'&quot; &amp; aValue <font color="#808080"><i>' apostroph forces string</i></font>

<font color="#808080"><i> ' insert as text for Writer --------------------</i></font>
 ElseIf oDocument.supportsService( &quot;com.sun.star.text.TextDocument&quot; ) Then
 oSelection = oDocument.CurrentSelection( 0 )
 oSelection.Text.insertString( oSelection, aValue, True )

 EndIf
End Sub</pre>
<h3><br />
  <br />
  4.4 <a name="hilfsfunktionzahlenformat">Hilfsfunktion zum Setzen eines Zahlenformates</a></h3>
<pre><font color="#808080"><i>'-------------------------------------------------
' Sets the passed number format as property of an object.
'
' parameter oController
' The controller that contains a number formatter.
'
' parameter oDestObj
' The destination object. Format is set at its NumberFormat property.
'
' parameter aFormat
' The string representation of the number format,
' or empty string to use the passed default format.
'
' parameter nStdFormat
' Index of a default number format (com.sun.star.util.NumberFormat
' constants), if no string is specified.
'-------------------------------------------------</i></font>

Sub Set_Number_Format(_
 oController As Object,_
 oDestObj As Object,_
 aFormat As String,_
 nStdFormat As Integer )

 Dim aLocale As New com.sun.star.lang.Locale
 oFormatter = oController.Model.NumberFormats

 If aFormat = &quot;&quot; Then
 oDestObj.NumberFormat = oFormatter.getStandardFormat( nStdFormat, aLocale )
 Else
 Dim nKey As Long
 nKey = oFormatter.queryKey( aFormat, aLocale, True )
 If nKey &lt; 0 Then
 nKey = oFormatter.addNew( aFormat, aLocale )
 EndIf
 oDestObj.NumberFormat = nKey
 EndIf
End Sub</pre>
<h3><br />
  <br />
  4.5 <a name="hilfsfunktionwert">Hilfsfunktion zum Einf&uuml;gen als Wert oder Textfeld</a></h3>
<pre><font color="#808080"><i>'-------------------------------------------------
' Inserts the passed string as value into a document.
'
' parameter aValue
' The string representation of a value (date or time).
'
' parameter aFormat
' The string representation of the number format,
' or empty string to use the passed default format.
'
' parameter nStdFormat
' Index of a default number format (com.sun.star.util.NumberFormat
' constants), if no string is specified.
'-------------------------------------------------</i></font>

Sub Insert_As_Value(_
 aValue As String,_
 aFormat As String,_
 nStdFormat As Integer )

 oDesktop = createUnoService( &quot;com.sun.star.frame.Desktop&quot; )
 oController = oDesktop.CurrentFrame.Controller
 oDocument = oController.Model

<font color="#808080"><i> ' insert as value for Calc ---------------------</i></font>
 If oDocument.supportsService( &quot;com.sun.star.sheet.SpreadsheetDocument&quot; ) Then
 oSelection = oController.Selection
 oSelection.FormulaLocal = aValue
 Set_Number_Format( oController, oSelection, aFormat, nStdFormat )

<font color="#808080"><i> ' insert as value for Writer -------------------</i></font>
 ElseIf oDocument.supportsService( &quot;com.sun.star.text.TextDocument&quot; ) Then
 <font color="#808080"><i> ' create a text field </i></font>
 oField = oDocument.createInstance( &quot;com.sun.star.text.TextField.DateTime&quot; )
 oField.IsFixed = True
 Set_Number_Format( oController, oField, aFormat, nStdFormat )
<font color="#808080"><i> ' insert into current selection</i></font>
 oSelection = oDocument.CurrentSelection( 0 )
 oSelection.Text.insertTextContent( oSelection, oField, True )

 End If
End Sub</font></pre>
<h3><br />
  <br />
  4.6 <a name="erlaeuterungen">Erl&auml;uterungen</a></h3>
<p> Die Hauptfunktionen rufen je eine Hilfsfunktion mit den entsprechenden Parametern auf. Diese Hilfsfunktionen (Insert_As_Text und Insert_As_Value) erkennen, von welchem Dokumenttyp das Makro aufgerufen wurde. Dann werden die passenden Funktion aufgerufen, um den Wert in das Dokument einzuf&uuml;gen.</p>
<p>Um f&uuml;r Wertezellen oder Textfelder ein selbstdefiniertes Zahlenformat zu setzen, wird die Formatdefinition einfach in den Hauptfunktionen Insert_Date_As_Value und Insert_Time_As_Value mit &uuml;bergeben. Wenn hier ein Leertext angegeben wird, verwenden die aufgerufenen Hilfsfunktionen das angegebene Standardformat.</p>
<h2><br />
  <br />
  5. <a name="tastaturkuerzel">Tastaturk&uuml;rzel</a></h2>
<p>In OpenOffice.org kann man nicht alle Tasten mit Funktionen belegen, z.B. ist es nicht m&ouml;glich, die Punkt- und Komma-Taste zu belegen, wohl aber die Plus-, Minus- oder Stern-Taste. Allerdings sind viele dieser Tasten bereits belegt (dazu sp&auml;ter mehr). Deshalb werden in diesem Beispiel die Tastenkombinationen Strg+Umschalt +7 bis Strg+Umschalt+0 benutzt. Diese sind in Text- und Tabellendokumenten noch frei.</p>
<p>Im Dialog <i>Extras-&gt;Anpassen</i> im Karteireiter <i>Tastatur</i> w&auml;hlen Sie zuerst (wichtig!) oben rechts <i>OpenOffice.org</i> aus, um das neue K&uuml;rzel f&uuml;r alle Applikationen zu definieren. Danach w&auml;hlen Sie in den unteren Listenfeldern Ihr BASIC-Makro aus. Zuerst w&auml;hlen Sie im linken Listenfeld <i>Bereich </i>das Modul <i>OpenOffice.org BASIC-Makros-&gt;Standard-&gt;Module1</i> [1.0] und [1.1] bzw. <i>OpenOffice.org BASIC-Makros-&gt;user-&gt;Standard-&gt;Module1</i> [2.0], dann daneben im Feld <i>Funktion</i> das Makro Insert_Date_As_Text. Jetzt k&ouml;nnen Sie im oberen Teil des Dialogs ein Tastaturk&uuml;rzel ausw&auml;hlen. W&auml;hlen Sie die Kombination Strg+Umschalt+7 aus, und dr&uuml;cken dann die Schaltfl&auml;che <i>&Auml;ndern</i>. Ebenso verfahren Sie mit den anderen Tastenk&uuml;rzeln:</p>
<table width="100%" border="1" cellpadding="2" cellspacing="0">
  <col width="90" />
  <col width="166" />
  <tbody>
    <tr valign="top">
      <td width="35%" bgcolor="#e6e6e6"><p>Tastaturk&uuml;rzel</p></td>
      <td width="65%" bgcolor="#e6e6e6"><p>Makrofunktion</p></td>
    </tr>
  </tbody>
  <tbody>
    <tr valign="top">
      <td width="35%"><p>Strg+Umschalt+7</p></td>
      <td width="65%"><p>Insert_Date_As_Text</p></td>
    </tr>
    <tr valign="top">
      <td width="35%"><p>Strg+Umschalt+8</p></td>
      <td width="65%"><p>Insert_Time_As_Text</p></td>
    </tr>
    <tr valign="top">
      <td width="35%"><p>Strg+Umschalt+9</p></td>
      <td width="65%"><p>Insert_Date_As_Value</p></td>
    </tr>
    <tr valign="top">
      <td width="35%"><p>Strg+Umschalt+0</p></td>
      <td width="65%"><p>Insert_Time_As_Value</p></td>
    </tr>
  </tbody>
</table>
<p>Das ist auch schon alles. Ein schneller Test in einem Text- und einem Tabellendokument sollte nun das gew&uuml;nschte Ergebnis liefern.</p>
<p>Wie bereits erw&auml;hnt, sind viele Tastaturk&uuml;rzel bereits belegt. Das kann unerwartete &Uuml;berraschungen zur Folge haben. Man kann ein K&uuml;rzel global (f&uuml;r alle Dokumenttypen) zuweisen; aber in einem speziellen Dokumenttyp dasselbe K&uuml;rzel mit einer anderen Funktion &uuml;berschreiben. Zum Beispiel ist Strg+Plus global frei, aber in Textdokumenten belegt. Wenn Sie jetzt Strg+Plus global belegen, wird das in Textdokumenten nicht funktionieren, da zuerst die dokument-spezifischen K&uuml;rzel gesucht und benutzt werden. Sie m&uuml;ssten also zus&auml;tzlich im Tastatur-Dialog das Textdokument-K&uuml;rzel freigeben.</p>

      
    </div>
    <!--#include virtual="/footer.html" -->
  </body>
</html>
