

<!--#include virtual="/doctype.html" -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <link href="/css/ooo.css" rel="stylesheet" type="text/css">
    
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="StarOffice 6.0  (Win32)">
	<META NAME="CREATED" CONTENT="20011123;18135200">
	<META NAME="CHANGED" CONTENT="20011128;10004660">


    
    <script src="https://www.apachecon.com/event-images/snippet.js"></script>
  </head>
  <body LANG="de-DE">
    <!--#include virtual="/brand.html" -->
    <div id="topbara">
      <!--#include virtual="/topnav.html" -->
      <div id="breadcrumbsa"><a href="/">home</a>&nbsp;&raquo;&nbsp;<a href="/framework/">framework</a>&nbsp;&raquo;&nbsp;<a href="/framework/proposals/">proposals</a>&nbsp;&raquo;&nbsp;<a href="/framework/proposals/macro_security/">macro_security</a></div>
    </div>
    <div id="clear"></div>
      
      
    <div id="content">
      
      
<H1 CLASS="western"><SPAN LANG="en-US">Security Enhancements in
StarOffice 6.0 / OpenOffice.org according to IssueZilla Bug
#1120 
</span></H1>
<SPAN LANG="en-US"> 
<H1 CLASS="western"> Problem to Solve</H1>
<OL>
  <P LANG="en-US" STYLE="margin-bottom: 0cm">Macros in all documents, executed 
    via file:// url; will be executed without warning.</P>
</OL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<OL>
  <H2 CLASS="western">Solution</H2>
</OL>
<OL>
  <P STYLE="margin-bottom: 0cm"><SPAN LANG="en-US">A solution to solve this problem 
    is to give users the possibility to set all macro related security settings 
    in <I>Tools-Option-Security </I><SPAN STYLE="font-style: normal">tab.</SPAN></SPAN></P>
</OL>
<OL>
  <P LANG="en-US" STYLE="margin-bottom: 0cm; font-style: normal">The following 
    steps should solve the problem.</P>
</OL>
<P LANG="en-US" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
</P>
<OL>
  <H3 CLASS="western"><B>Path Settings</B></H3>
  <P CLASS="western">The path list (<I>Tools-Options-Security</I>) contains all 
    trusted path given by users. The default<BR>
    'file://' entry in the path list should be replace by more precise paths listed 
    below:</P>
</OL>
<P LANG="en-US" STYLE="margin-bottom: 0cm; font-style: normal"><BR>
</P>
<UL>
  <LI> 
    <P LANG="en-US" STYLE="margin-bottom: 0cm">$instURL</P>
  <LI> 
    <P STYLE="margin-bottom: 0cm">$userURL</P>
  <LI> 
    <P LANG="en-US" STYLE="margin-bottom: 0cm">$workDIR</P>
</UL>
<P LANG="en-US" STYLE="margin-left: 0.53cm; margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-left: 0.53cm; margin-bottom: 0cm"><SPAN LANG="en-US">All path 
  has to point to standard folders. Changing the old file URL to the three new 
  once provides more security due to the fact that users do not have the possibility 
  to run macros from directories like <I>Temp for </I><SPAN STYLE="font-style: normal">example.</SPAN></SPAN></P>
<P STYLE="margin-left: 0.53cm; margin-bottom: 0cm"><BR>
</P>
<OL START=2>
  <H3 CLASS="western"><B>Run Macro Settings</B></H3>
  <P STYLE="margin-bottom: 0cm">The three radio buttons (From list, Never execute, 
    Always execute) located on the Tools-Options-Security page will be replace 
    by a dropdown list box (labeled <I>Run macros</I>) which contains the three 
    options</P>
  <P LANG="en-US" STYLE="margin-bottom: 0cm; font-style: normal">
  <SPAN ID="Frame1" STYLE="float: left; width: 15.88cm; height: 0.53cm; padding: 0cm; background: #ffffff"> 
  <TABLE WIDTH=100% BORDER=1 BORDERCOLOR="#000000" CELLPADDING=4 CELLSPACING=0>
    <COL WIDTH=128*> <COL WIDTH=128*> <THEAD> 
    <TR VALIGN=TOP> 
      <TH WIDTH=50%> 
        <P CLASS="western">Old Term</P>
      </TH>
      <TH WIDTH=50%> 
        <P CLASS="western">New Term</P>
      </TH>
    </TR>
    </THEAD> <TBODY> 
    <TR VALIGN=TOP> 
      <TD WIDTH=50%> 
        <P CLASS="western">From list</P>
      </TD>
      <TD WIDTH=50%> 
        <P CLASS="western">According to path list</P>
      </TD>
    </TR>
    <TR VALIGN=TOP> 
      <TD WIDTH=50%> 
        <P LANG="en-US" CLASS="western">Never execute</P>
      </TD>
      <TD WIDTH=50%> 
        <P CLASS="western">Never</P>
      </TD>
    </TR>
    <TR VALIGN=TOP> 
      <TD WIDTH=50%> 
        <P LANG="en-US" CLASS="western">Always execute</P>
      </TD>
      <TD WIDTH=50%> 
        <P CLASS="western">Always</P>
      </TD>
    </TR>
    </TBODY> 
  </TABLE>
  <P CLASS="frame-contents-western"><BR>
    <BR>
  </P>
  </SPAN><BR CLEAR=LEFT>
  The options will be renamed as listed below:<BR>
  In addition beneath to the <I>Run</I> <I>macros</I> dropdown list box are located 
  two check boxes. The first one is labeled <I>Confirm in the case of other document 
  sources</I> the other is labeled <I>Show warning before running macros. </I>The<I> 
  Show warning before running </I>feature is the renamed and removed feature of 
  Tools-Configure-Events / Security settings (Figure <A HREF="#Graphic1|graphic">1</A> 
  &amp; <A HREF="#Graphic2|graphic">2</A>)<BR>
  <BR>
  The<I> Confirm in the case of other document sources</I> option will be enabled 
  if users chose the <I>According to path list</I> option in the dropdown list, 
  otherwise the Confirm ..... item remains disabled (grayed out).<BR>
  <BR>
  <p></P>
  <P STYLE="margin-bottom: 0cm"><SPAN LANG="en-US"><SPAN STYLE="font-style: normal">The 
    </SPAN><I>Show warning before running macros </I><SPAN STYLE="font-style: normal">option 
    will be disabled if the option </SPAN><I>Never</I><SPAN STYLE="font-style: normal"> 
    was chosen in the </SPAN><I>Run Macros</I><SPAN STYLE="font-style: normal"> 
    dropdown list box. The states are illustrated in Figure <A HREF="#Graphic3|graphic">3</A>,<A HREF="#Graphic4|graphic">4</A>,<A HREF="#Graphic4|graphic">5</A> 
    &amp; </SPAN></SPAN><A HREF="#Graphic6|graphic">6</A>.<BR>
    <BR>
  </P>
  <H3 CLASS="western" STYLE="font-style: normal"><B>Warning Message</B></H3>
  <P LANG="en-US" STYLE="margin-bottom: 0cm"><SPAN STYLE="font-style: normal">The 
    warning message which appears, if a macro will be run from a </SPAN>location 
    which is not trusted, should be expanded by a more detailed information. The 
    renewed warning dialogue needs much space for text than the old one.</P>
  <P STYLE="margin-bottom: 0cm"><SPAN LANG="en-US"><BR>
    <B>Current Text</B><BR>
    <I>An event to which a macro is configured has been started. Do you want to 
    execute the macro?</I><BR>
    <BR>
    <SPAN STYLE="font-style: normal">CheckBox</SPAN><I> Do not warn again for 
    this document</I>.<BR>
    OKButton <I>Run</I><BR>
    CancelButton <I>Don't</I> <I>run</I></SPAN></P>
  <P STYLE="margin-bottom: 0cm"><SPAN LANG="en-US"><BR>
    <B>New Text (macro title is an example):</B><BR>
    <I>An event to which a macro, called &quot;soffice.Gimmicks..GetTexts. GetCalcGraphicNames&quot;, 
    is configured has been started. Do you want to run the macro?<BR>
    <BR>
    </I><SPAN STYLE="font-style: normal">CheckBox</SPAN><I> Do not warn again 
    for this document</I></SPAN>.<BR>
    OKButton <I>Run</I><BR>
    CancelButton <I>Don't</I> <I>run</I></P>
  <H3 CLASS="western"><BR>
    Illustrations</H3>
</OL>
<P CLASS="western">
<SPAN ID="Frame2" STYLE="background: #ffffff"
	> 
<P STYLE="margin-top: 0.21cm"><A NAME="Graphic1|graphic"></A></P>
</SPAN><span lang="en-US"><span id="Frame2" style="background: #ffffff"
	><img src="security_enhancements_html_m2dbadf08.gif" name="Graphic1" align=LEFT width=572 border=0 height="422"></span></span><SPAN ID="Frame2" STYLE="background: #ffffff"
	> 
<P STYLE="margin-top: 0.21cm"><BR CLEAR=LEFT>
  <FONT SIZE=2><I>Illustration 1 current Configuration/Events tab</I></FONT></P>
</SPAN><BR CLEAR=LEFT>
<BR>
<BR>
<p></P>
<P CLASS="western"><BR>
  <BR>
</P>
<P CLASS="western"><BR>
  <BR>
</P>
<P CLASS="western"><BR>
  <BR>
</P>
<P CLASS="western">
<SPAN ID="Frame3" STYLE="background: #ffffff"
	> 
<P STYLE="margin-top: 0.21cm"><A NAME="Graphic2|graphic"></A><IMG SRC="security_enhancements_html_51f79ff8.gif" NAME="Graphic2" ALIGN=LEFT WIDTH=572 BORDER=0 height="422"><BR CLEAR=LEFT>
  <FONT SIZE=2><I> Illustration 2 Configuration/Events dialogue after removing 
  the &quot;Show warning&quot; option.</I></FONT></P>
</SPAN><BR CLEAR=LEFT>
<BR>
<BR>
<p></P>
<P CLASS="western">
<SPAN ID="Frame4" STYLE="background: #ffffff"
	> 
<P STYLE="margin-top: 0.21cm"><A NAME="Graphic3|graphic"></A><IMG SRC="security_enhancements_html_70928bb3.gif" NAME="Graphic3" ALIGN=LEFT WIDTH=536 BORDER=0 height="371"><BR CLEAR=LEFT>
  <FONT SIZE=2><I>Illustration 3 Renewed Tool Options Security dialogue </I></FONT> 
</P>
</SPAN><BR CLEAR=LEFT>
<BR>
<BR>
<p></P>
<P CLASS="western">
<SPAN ID="Frame5" STYLE="background: #ffffff"
	> 
<P STYLE="margin-top: 0.21cm"><A NAME="Graphic4|graphic"></A><IMG SRC="security_enhancements_html_m4000e9d0.gif" NAME="Graphic4" ALIGN=LEFT WIDTH=536 BORDER=0><BR CLEAR=LEFT>
  <FONT SIZE=2><I>Illustration 4 The security dialogue with &quot;Run macro Never&quot; 
  option</I></FONT></P>
</SPAN><BR CLEAR=LEFT>
<BR>
<BR>
<p></P>
<P CLASS="western"><BR>
  <BR>
</P>
<P CLASS="western">
<SPAN ID="Frame6" STYLE="background: #ffffff"
	> 
<P STYLE="margin-top: 0.21cm"><IMG SRC="security_enhancements_html_m4acea22c.gif" NAME="Graphic5" ALIGN=LEFT WIDTH=536 BORDER=0><BR CLEAR=LEFT>
  <FONT SIZE=2><I>Illustration 5 The security dialogue with &quot;Run macro Alway&quot; 
  option</I></FONT></P>
</SPAN><BR CLEAR=LEFT>
<BR>
<BR>
<p></P>
<P CLASS="western">
<SPAN ID="Frame7" STYLE="background: #ffffff"> 
<P STYLE="margin-top: 0.21cm"><A NAME="Graphic6|graphic"></A><IMG SRC="security_enhancements_html_md0eecca.gif" NAME="Graphic6" ALIGN=LEFT WIDTH=536 BORDER=0><BR CLEAR=LEFT>
  <FONT SIZE=2><I>Illustration 6 German Version of the new features</I></FONT></P>
</SPAN><BR>
<BR>
<p></P>
</span> 

      
    </div>
    <!--#include virtual="/footer.html" -->
  </body>
</html>
