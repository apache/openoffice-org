<html>
<head>
<title>Developer Guide for NetBeans</title>

<meta HTTP-EQUIV="content-type" CONTENT="text/html; charset=UTF-8">
</head>

<body>
<a name="top"></a>     

<h1>Developer Guide for NetBeans</h1>
         
This document describes how to set up NetBeans for Office Scripting
in Java and how to write a simple script using NetBeans. You can download
the NetBeans IDE from the <a href="http://www.netbeans.org/ide/download.html">
NetBeans download page</a>.

<h2>Contents:</h2>

<ul>
<li><p><a href="#prerequisites">Pre-requisites</a>
<li><p><a href="#recipe-create">Creating a Parcel Recipe</a>
<li><p><a href="#recipe-actions">Actions available for Parcel Recipes</a>
<li><p><a href="#parcel-actions">Actions available for Script Parcels</a>
<li><p><a href="#document-actions">Actions available for Office Documents</a>
<li><p><a href="#debugging">Debugging Office scripts in NetBeans</a>
<li><p><a href="#troubleshooting">Troubleshooting</a>
</ul>

<h2>Pre-requisites</h2>

<ul>
<!-- <li>You need to install the Office API support module for NetBeans which
can be obtained from
<a href="http://api.openoffice.org/common/man/IDEintegration/OfficeNetBeansIntegration.html">here</a>.
This module must be installed in NetBeans if you wish to use the
Office API in your scripts.
-->

<li>The Office Scripting module works with NetBeans 3.4

<li>You should have installed the Office Scripting module during the
installation process for the Scripting Framework. If you have not installed
it, see the <a href="install-guide.html">Installation Guide</a> for
instructions on how to install.

<li>On Linux, you will need to ensure that your DISPLAY environment
variable is set to &lt;your hostname&gt;:0 in the shell from which you
start NetBeans to work around a problem with Java GUIs in
Office.

<li>Create a directory somewhere on your machine in which you will develop
your scripts.
</ul>

Now start NetBeans and mount the directory you created using the
File/Mount Filesystem menu option. You also need to mount all of the jar
files in the &lt;Office installation&gt;/program/classes directory in
order to access the Office API from your scripts.
<p>
<a href="#top">Top</a>

<p>
<a name="recipe-create"></a>
<h2>Creating a Parcel Recipe</h2>

Office scripts are delivered in Script Parcels. Like Office documents they
are zip files. Script Parcels have the .sxp extension. Script Parcels are
generated from Parcel Recipes where all of the files that are necessary
to create the parcel are put together. To create a new Parcel Recipe:

<ul>
<li>Right click on your mounted filesystem
<li>Select New/Office Scripting/Parcel Recipe
<li>In the New Wizard window that appears you can enter a name for your
Parcel Recipe or you can leave it as default
<li>Click the Finish button to create your Parcel Recipe
</ul>
                         
This will create a new directory with the name you chose. In this directory
you will find a Contents directory where all of your java source files will
be placed. An empty stub file Empty.java will have been placed in the
Contents directory and can be used as a starting point for your script.
<p>
<a href="#top">Top</a>

<p>
<a name="recipe-actions"></a>
<h2>Actions available for Parcel Recipe</h2>

If the user right clicks on the parcel directory they should be
able to use the following actions:

<ul>
<li><b>Compile:</b> Compiles all of the .java files in the Parcel Recipe

<li><b>Build:</b> Compiles all of the .java files in the Parcel Recipe.
It then introspects on the generated class files and pops up a dialog
which allows you to select which methods you wish to export as scripts.
Once you have selected the methods to export, it creates a
&lt;Parcel Recipe Name&gt;.sxp Script Parcel file in the Parcel
Recipe directory. You can configure what files are put into the
Script Parcel using the File Filter property.

<li><b>Configure:</b> This pops up the Configure dialog, which allows you
to select which methods get exported as scripts. Any changes you make in
this dialog will <b>only</b> appear in your Script Parcel after you run
Build again.
</ul>
<p>
<a href="#top">Top</a>

<p>
<a name="parcel-actions"></a>
<h2>Actions available for Script Parcels</h2>

Script Parcels supports only one action:

<ul>
<li><b>Deploy:</b> This will deploy the Script Parcel to an Office Document
or to an Office installation. If the Script Parcel already exists
in the target, you will be asked whether you want to overwrite.
</ul>

<p>
<b>Note:</b> If you deploy a Script Parcel to an OpenOffice.org
installation you need to use the Tools/Refresh User Scripts (Java) menu
item for the new script to appear in the Assign Script dialog.

<p>
<b>Note:</b> You can also deploy to Office documents within NetBeans
using drag and drop or cut and paste.
<p>
<a href="#top">Top</a>

<p>
<a name="document-actions"></a>
<h2>Actions available for Office Documents</h2>

Office Documents are also recognised by NetBeans. Any parcels contained
in the document will be displayed as nodes of the Office document. Deleting
one of these nodes will remove the Script Parcel from the document.

Office documents support the standard Delete, Cut and Copy actions and
the following custom actions:

<ul>
<li><b>Open:</b> This will open the document in Office using the path
in the Office Settings property to find the Office installation.

<p>
If the path to Office is not valid, an error dialog will be popped
up informing the user that they need to set their Path to Office
Installation property. This setting can be changed by bringing
up the Tools/Options dialog and changing
IDE Configuration/Server and External Tool Settings/Office Settings
</ul>
<p>
<a href="#top">Top</a>

<p>
<a name="debugging"></a>
<h2>Debugging Office scripts in NetBeans</h2>

<ul>
<li>Follow the instructions at
<a href="http://api.openoffice.org/common/man/IDEintegration/OfficeNetBeansIntegration.html#Debugging">
Debugging Java components in NetBeans/Forte for Java</a>
to set up your Office installation to allow debugging of the JVM.

<li>Start OpenOffice and run one of your Java scripts. This will
make sure the JVM is running.

<li>Attach to Office JVM using the NetBeans Debug/Start Session/Attach...
menu option.

<li>Load a script source in NetBeans and set up breakpoints using
Debug/New Breakpoint... menu option.

<li>Run the script in Office.
</ul>
<p>
<a href="#top">Top</a>

<p>
<a name="troubleshooting"></a>
<h2>Troubleshooting</h2>

<ul>
<li><p>If you encounter problems when developing or deploying scripts in
NetBeans, one thing you can try is to move your NetBeans settings directory
(.netbeans on UNIX, netbeans in Windows - can be found in your home
directory) to another name and restart NetBeans.

<li><p>The Choose Methods to Export as Scripts dialog <b>only</b> displays
methods which are defined within class files, it will not display
methods in class files which are within jar files in the Parcel Recipe.

<li><p>If you include package directives in the java source files of your
Parcel Recipe, the class files generated when compiling will not get placed
in subdirectories reflecting your package directive. This is because the
default NetBeans compiler implementation does not use the -d switch to the
Java compiler. As a result methods in these classes will not appear in the
Choose Methods to Export as Scripts dialog.
</ul>

<p>
<a href="#top">Top</a>

<hr>
Last Modified: Fri Nov 29 14:19:53 GMT 2002

</body>
</html>
