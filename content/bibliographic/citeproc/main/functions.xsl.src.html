

<!--#include virtual="/doctype.html" -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <link href="/css/ooo.css" rel="stylesheet" type="text/css">
    <title>XML source view</title><link rel="stylesheet" type="text/css" href="../xmlverbatim.css"/>
    
    <script src="https://www.apachecon.com/event-images/snippet.js"></script>
  </head>
  <body class="xmlverb-default">
    <!--#include virtual="/brand.html" -->
    <div id="topbara">
      <!--#include virtual="/topnav.html" -->
      <div id="breadcrumbsa"><a href="/">home</a>&nbsp;&raquo;&nbsp;<a href="/bibliographic/">bibliographic</a>&nbsp;&raquo;&nbsp;<a href="/bibliographic/citeproc/">citeproc</a>&nbsp;&raquo;&nbsp;<a href="/bibliographic/citeproc/main/">main</a></div>
    </div>
    <div id="clear"></div>
      
      
    <div id="content">
      
      <tt>
<!-- converted by xmlverbatim.xsl 1.1, (c) O. Becker -->
<div xmlns:xd="http://www.pnp-software.com/XSLTdoc" class="xmlverb-default">&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e1">stylesheet</a></span><span class="xmlverb-ns-name"> xmlns:bib</span>="<span class="xmlverb-ns-uri">http://purl.org/NET/xbiblio/citeproc</span>"<span class="xmlverb-ns-name"> xmlns:cs</span>="<span class="xmlverb-ns-uri">http://purl.org/NET/xbiblio/csl</span>"<span class="xmlverb-ns-name"> xmlns:db</span>="<span class="xmlverb-ns-uri">http://docbook.org/ns/docbook</span>"<span class="xmlverb-ns-name"> xmlns:mods</span>="<span class="xmlverb-ns-uri">http://www.loc.gov/mods/v3</span>"<span class="xmlverb-ns-name"> xmlns:xs</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2001/XMLSchema</span>"<span class="xmlverb-ns-name"> xmlns:xdoc</span>="<span class="xmlverb-ns-uri">http://www.pnp-software.com/XSLTdoc</span>"<span class="xmlverb-ns-name"> xmlns:xsl</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/XSL/Transform</span>" <span class="xmlverb-attr-name">version</span>="<span class="xmlverb-attr-content">2.0</span>" <span class="xmlverb-attr-name">exclude-result-prefixes</span>="<span class="xmlverb-attr-content">xdoc mods xs cs bib</span>"&gt;<span class="xmlverb-text"><br/>
��</span>&lt;!--<span class="xmlverb-comment">�===�licensed�under�CC-GNU�GPL;�see�http://creativecommons.org/licenses/GPL/2.0�===�</span>--&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e5">doc</a></span> <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">stylesheet</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e7">short</a></span>&gt;<span class="xmlverb-text">CiteProc�functions.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e10">author</a></span>&gt;<span class="xmlverb-text">Bruce�D&#8217;Arcus</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">author</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e13">copyright</a></span>&gt;<span class="xmlverb-text">2004</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">copyright</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;!--<span class="xmlverb-comment">�||||�date�functions�||||�</span>--&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e19">doc</a></span>&gt;<span class="xmlverb-text">when�given�a�bibliographic�record,�returns�its�publication�year</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e22">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mods:year</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e24">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibref</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e26">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibref</span>"&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e28">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">xsd-date</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">(mods:originInfo/mods:dateIssued, mods:relatedItem/mods:originInfo/mods:dateIssued, mods:relatedItem/mods:part/mods:date)[1]</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e30">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">substring($xsd-date,1,4)</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;!--<span class="xmlverb-comment">�||||�number�handling�functions�||||�</span>--&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e36">doc</a></span>&gt;<span class="xmlverb-text">Collapses�a�page�range�according�to�the�Chicago�algorithm.�Probably�needs�to�be<br/>
����generalized.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e39">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bib:number-condense</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e41">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">begin</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e43">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">end</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e45">choose</a></span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e47">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$begin castable as xs:integer</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e49">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">begin</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">xs:integer($begin)</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:integer</span>" /&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e51">choose</a></span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e53">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$begin gt 100 and $begin mod 100 and $begin idiv 100 eq $end idiv 100</span>"&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e55">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$end mod 100</span>" /&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e58">otherwise</a></span>&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e60">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$end</span>" /&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e65">otherwise</a></span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e67">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$end</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e72">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">primary-contributors</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">('author', 'editor', 'creator', 'speaker', 'reviewer')</span>" /&gt;<span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e74">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">secondary-contributors</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">('translator')</span>" /&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e76">doc</a></span>&gt;<span class="xmlverb-text">Constructs�an�authors�string�for�grouping�and�sorting.�This�function�concatenates�all<br/>
����authors�into�a�string�so�that�multiple-authors�get�correctly�grouped.�Where�no�author�exists�it<br/>
����substitutes�based�on�CSL�definitions.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e79">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mods:grouping-key</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e81">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibref</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e83">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sort-on</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">mods:sort_on($bibref)</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e85">choose</a></span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e87">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$sort-on='creator'</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e89">value-of</a></span> <span class="xmlverb-attr-name">separator</span>="<span class="xmlverb-attr-content">;</span>"&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e91">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibref/mods:name[mods:role/mods:roleTerm=$primary-contributors]</span>"&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e93">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">string-join((mods:namePart[@type='family'] | mods:namePart[not(@type)],mods:namePart[@type='given']), ',')</span>" /&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">value-of</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e98">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$sort-on='container-title'</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e100">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibref/mods:relatedItem[@type='host']/mods:titleInfo/mods:title</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e103">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$sort-on='title'</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e105">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibref/mods:titleInfo/mods:title</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e108">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$sort-on='anonymous'</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e110">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'Anonymous'</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e115">doc</a></span>&gt;<span class="xmlverb-text">Determines�what�to�sort�on.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e118">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mods:sort_on</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e120">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibref</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e122">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">use-reftype</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">mods:use_csl-reftype($bibref)</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e124">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">csl_path</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($citeclass='note-nobib') then $style-citation/cs:first/cs:layout/cs:reftype[@name=$use-reftype] else $style-biblio/cs:layout/cs:reftype[@name=$use-reftype]</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e126">choose</a></span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e128">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$csl_path/cs:creator[1]</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e130">choose</a></span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e132">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$bibref/mods:name[mods:role/mods:roleTerm=$primary-contributors]</span>"&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e134">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'creator'</span>" /&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e137">otherwise</a></span>&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e139">choose</a></span>&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e141">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$csl_path/cs:creator/@alternate-sortkey='container-title'</span>"&gt;<span class="xmlverb-text"><br/>
����������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e143">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'container-title'</span>" /&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e146">otherwise</a></span>&gt;<span class="xmlverb-text"><br/>
����������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e148">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'anonymous'</span>" /&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e155">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$csl_path/cs:title[1]</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e157">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'title'</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e162">doc</a></span>&gt;<span class="xmlverb-text">Determines�which�CSL�definition�to�use�for�any�given�MODS�record.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e165">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mods:use_csl-reftype</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e167">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibref</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e169">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if (mods:csl-reftype($bibref)) then (mods:csl-reftype($bibref)) else (mods:csl-fallback($bibref))</span>" /&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e172">doc</a></span>&gt;<span class="xmlverb-text">Maps�a�MODS�reference�type�to�a�CSL�XPATH�expression.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e175">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mods:csl-reftype</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e177">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibref</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e179">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">reftype</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">mods:reftype($bibref)</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e181">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">csl-style</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">if ($citeclass='note-nobib') then ($style-citation/cs:first/cs:layout/cs:reftype) else ($style-biblio/cs:layout/cs:reftype)</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e183">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$csl-style/@name[.=$reftype]</span>" /&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e186">doc</a></span>&gt;<span class="xmlverb-text">Determines�the�CSL�fallback�for�a�MODS�record.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e189">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mods:csl-fallback</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e191">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibref</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e193">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibrefclass</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">mods:refclass($bibref)</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e195">choose</a></span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e197">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$bibrefclass='monograph'</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e199">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'book'</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e202">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$bibrefclass='part-inMonograph'</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e204">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'chapter'</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e207">otherwise</a></span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e209">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">'article'</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e214">doc</a></span>&gt;<span class="xmlverb-text">This�function�is�central�to�the�formatting�logic�of�the�system.�The�fallback�system<br/>
����classifies�records�into�one�of�three�structural�classes:�part-inMongraph,�part-inSerial,�and<br/>
����mongraph.�It�would�be�easy�to�add�serial�as�a�fourth,�but�I�have�not�yet�found�the�need�(does<br/>
����one�ever�cite�a�serial�as�a�whole?).</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e217">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mods:refclass</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e219">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibref</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)?</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e221">choose</a></span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e223">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$bibref/mods:relatedItem[@type='host']</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e225">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">issuance</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibref/mods:relatedItem/mods:originInfo/mods:issuance</span>" /&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e227">choose</a></span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e229">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$issuance='monographic'</span>"&gt;<span class="xmlverb-text">part-inMonograph</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e232">otherwise</a></span>&gt;<span class="xmlverb-text">part-inSerial</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e237">otherwise</a></span>&gt;<span class="xmlverb-text">monograph</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e242">doc</a></span>&gt;<span class="xmlverb-text">Further�classifies�records�into�types�based�on�the�class.�These�types�then�map�onto�the<br/>
����citation�style�langauge�definitions.�Article,�chapter�and�book�are�the�default�structures�and<br/>
����generic�fallbacks.�Most�records�will�be�formatted�with�these�"types."�Beyond�these�core�types,<br/>
����additional�types�would�be�defined�by�both�their�genre�values�and�their�likeness�to�the�core<br/>
����types.�The�value�can�be�multi-level�where�applicable:�e.g.�&#8220;article-magazine.&#8221;</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e245">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">mods:reftype</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e247">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibref</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)?</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e249">value-of</a></span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e251">choose</a></span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e253">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$bibref/mods:relatedItem/@type = 'host'</span>"&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e255">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">issuance</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibref/mods:relatedItem/mods:originInfo/mods:issuance</span>" /&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e257">choose</a></span>&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e259">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">mods:refclass($bibref) = 'part-inSerial'</span>"&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e261">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$bibref/mods:relatedItem/mods:genre=('periodical', 'magazine', 'academic journal', 'newspaper')</span>"&gt;<span class="xmlverb-text"><br/>
����������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e263">text</a></span>&gt;<span class="xmlverb-text">article</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br/>
����������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e266">text</a></span>&gt;<span class="xmlverb-text">-</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e270">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">($bibref/mods:relatedItem/mods:genre, $bibref/mods:genre)[1]</span>" /&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e273">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">mods:refclass($bibref) = 'part-inMonograph'</span>"&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e275">choose</a></span>&gt;<span class="xmlverb-text"><br/>
����������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e277">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$bibref/mods:genre</span>"&gt;<span class="xmlverb-text"><br/>
������������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e279">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibref/mods:genre</span>" /&gt;<span class="xmlverb-text"><br/>
����������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
����������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e282">otherwise</a></span>&gt;<span class="xmlverb-text"><br/>
������������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e284">text</a></span>&gt;<span class="xmlverb-text">chapter</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">text</span>&gt;<span class="xmlverb-text"><br/>
����������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e290">otherwise</a></span>&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e292">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibref/mods:genre</span>" /&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e297">otherwise</a></span>&gt;<span class="xmlverb-text">book</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">value-of</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e303">doc</a></span>&gt;<span class="xmlverb-text">Numbers�citations�and�foot/endnotes�together.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e306">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bib:number-footcite</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:string</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e308">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">footcite</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element()</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e310">choose</a></span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e312">when</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$chapters/db:chapter</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e314">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$footcite</span>"&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e316">number</a></span> <span class="xmlverb-attr-name">level</span>="<span class="xmlverb-attr-content">any</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">count</span>="<span class="xmlverb-attr-content">db:footnote|db:citation[not(ancestor::db:footnote)]</span>" <span class="xmlverb-attr-name">from</span>="<span class="xmlverb-attr-content">db:chapter</span>" /&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">when</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e320">otherwise</a></span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e322">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$footcite</span>"&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e324">number</a></span> <span class="xmlverb-attr-name">level</span>="<span class="xmlverb-attr-content">any</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">count</span>="<span class="xmlverb-attr-content">db:footnote|db:citation[not(ancestor::db:footnote)]</span>" /&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">otherwise</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">choose</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e330">doc</a></span>&gt;<span class="xmlverb-text">Determines�the�first�time�a�reference�is�cited�in�the�text.�Necesary�for�those�styles<br/>
����that�make�a�formatting�distinction�between�first�and�subsequent�references.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e333">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bib:first-reference</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e335">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">cite-ref</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e337">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$cite-ref is key('refs', $cite-ref/@linkend, root($cite-ref))[1]</span>" /&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d26e340">doc</a></span>&gt;<span class="xmlverb-text">Determines�when�a�citation�fulfills�the�"ibid"�condition.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e343">function</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bib:ibid</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e345">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">citation</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d26e347">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$citation/db:biblioref/@linkend = $citation/preceding::db:biblioref[1]/@linkend</span>" /&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">function</span>&gt;<span class="xmlverb-text"><br/>
</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">stylesheet</span>&gt;<br/>
</div>
</tt><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>v
         
      
    </div>
    <!--#include virtual="/footer.html" -->
  </body>
</html>
