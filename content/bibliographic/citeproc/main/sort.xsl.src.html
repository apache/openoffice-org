
<!--#include virtual="/doctype.html" -->
<html>
  <head>
    // This line is already part of every file. Adding it here is resulting in a double entry which is against the W3C standard.
    // <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <link href="/css/ooo.css" rel="stylesheet" type="text/css">
    <title>XML source view</title><link rel="stylesheet" type="text/css" href="../xmlverbatim.css"/>
    
    <script src="https://www.apachecon.com/event-images/snippet.js"></script>
  </head>
  <body class="xmlverb-default">
    <!--#include virtual="/brand.html" -->
    <div id="topbara">
      <!--#include virtual="/topnav.html" -->
      <div id="breadcrumbsa"><a href="/">home</a>&nbsp;&raquo;&nbsp;<a href="/bibliographic/">bibliographic</a>&nbsp;&raquo;&nbsp;<a href="/bibliographic/citeproc/">citeproc</a>&nbsp;&raquo;&nbsp;<a href="/bibliographic/citeproc/main/">main</a></div>
    </div>
    <div id="clear"></div>
      
      
    <div id="content">
      
      <tt>
<!-- converted by xmlverbatim.xsl 1.1, (c) O. Becker -->
<div xmlns:xd="http://www.pnp-software.com/XSLTdoc" class="xmlverb-default">&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e1">stylesheet</a></span><span class="xmlverb-ns-name"> xmlns:bib</span>="<span class="xmlverb-ns-uri">http://purl.org/NET/xbiblio/citeproc</span>"<span class="xmlverb-ns-name"> xmlns:cs</span>="<span class="xmlverb-ns-uri">http://purl.org/NET/xbiblio/csl</span>"<span class="xmlverb-ns-name"> xmlns:db</span>="<span class="xmlverb-ns-uri">http://docbook.org/ns/docbook</span>"<span class="xmlverb-ns-name"> xmlns:mods</span>="<span class="xmlverb-ns-uri">http://www.loc.gov/mods/v3</span>"<span class="xmlverb-ns-name"> xmlns:xs</span>="<span class="xmlverb-ns-uri">http://www.w3.org/2001/XMLSchema</span>"<span class="xmlverb-ns-name"> xmlns:exist</span>="<span class="xmlverb-ns-uri">http://exist.sourceforge.net/NS/exist</span>"<span class="xmlverb-ns-name"> xmlns:xdoc</span>="<span class="xmlverb-ns-uri">http://www.pnp-software.com/XSLTdoc</span>"<span class="xmlverb-ns-name"> xmlns:xhtml</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/xhtml</span>"<span class="xmlverb-ns-name"> xmlns:xsl</span>="<span class="xmlverb-ns-uri">http://www.w3.org/1999/XSL/Transform</span>"<span class="xmlverb-ns-name"> xmlns:course</span>="<span class="xmlverb-ns-uri">http://purl.org/NET/xbiblio/course</span>" <span class="xmlverb-attr-name">version</span>="<span class="xmlverb-attr-content">2.0</span>" <span class="xmlverb-attr-name">exclude-result-prefixes</span>="<span class="xmlverb-attr-content">xdoc mods xs bib exist course db cs</span>"&gt;<span class="xmlverb-text"><br/>
��</span>&lt;!--<span class="xmlverb-comment">�===�licensed�under�CC-GNU�GPL;�see�http://creativecommons.org/licenses/GPL/2.0�===�</span>--&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d29e5">doc</a></span> <span class="xmlverb-attr-name">type</span>="<span class="xmlverb-attr-content">stylesheet</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d29e7">short</a></span>&gt;<span class="xmlverb-text">Handles�sorting.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">short</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d29e10">author</a></span>&gt;<span class="xmlverb-text">Bruce�D&#8217;Arcus</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">author</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d29e13">copyright</a></span>&gt;<span class="xmlverb-text">2004,�Bruce�D&#8217;Arcus</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">copyright</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;!--<span class="xmlverb-comment">�===================================================================�</span>--&gt;<span class="xmlverb-text"><br/>
��</span>&lt;!--<span class="xmlverb-comment">�|����begin�bibliography�templates���������������������������������|�</span>--&gt;<span class="xmlverb-text"><br/>
��</span>&lt;!--<span class="xmlverb-comment">�===================================================================�</span>--&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d29e23">doc</a></span>&gt;<span class="xmlverb-text">Grouping,�sorting�and�parameter�setting�to�properly�handle�the<br/>
����author-year�class�bibliographies.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e26">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">mods:modsCollection</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">sort_author-year</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e28">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibref</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">mods:mods</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e30">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibref</span>" <span class="xmlverb-attr-name">group-by</span>="<span class="xmlverb-attr-content">mods:grouping-key(.)</span>"&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e32">sort</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-grouping-key()</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e34">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibrefs-for-author-sorted-by-year</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)*</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e36">perform-sort</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>"&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e38">sort</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">mods:year(.)</span>" /&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;!--<span class="xmlverb-comment">�add�third-level�sort�on�month-day�</span>--&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">perform-sort</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e44">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">first-bibref-for-author</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibrefs-for-author-sorted-by-year[1]</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e46">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sort-on</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-grouping-key()</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e48">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibrefs-for-author-sorted-by-year</span>" <span class="xmlverb-attr-name">group-adjacent</span>="<span class="xmlverb-attr-content">mods:year(.)</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e50">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>"&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e52">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">year-suffix</span>"&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e54">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">last() &amp;gt; 1</span>"&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e56">number</a></span> <span class="xmlverb-attr-name">value</span>="<span class="xmlverb-attr-content">position()</span>" <span class="xmlverb-attr-name">format</span>="<span class="xmlverb-attr-content">a</span>" /&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e60">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">shorten-author</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$style-biblio/@author-shorten='yes' and not(. is $first-bibref-for-author)</span>" /&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e62">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">enhance</span>"&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e64">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">year</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-grouping-key()</span>" /&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e66">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">year-suffix</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$year-suffix</span>" /&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e68">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">shorten-author</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$shorten-author</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" /&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e70">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sort-on</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$sort-on</span>" /&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e77">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">mods:modsCollection</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">sort_cited</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e79">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sort-on</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$cite-position/bib:refs/bib:unique/bib:ref[@key='{@ID}']/@position</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e81">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">mods:mods</span>"&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e83">sort</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$sort-on</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e85">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">enhance</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e87">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">year</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">mods:year(.)</span>" /&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e89">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sort-on</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$sort-on</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e94">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">mods:modsCollection</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">sort_citekey</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e96">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">mods:mods</span>"&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e98">sort</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@ID</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e100">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">enhance</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e102">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">year</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">mods:year(.)</span>" /&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e104">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sort-on</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@ID</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d29e109">doc</a></span>&gt;<span class="xmlverb-text">Adds�data�necessary�for�further�processing�to�the�in-memory<br/>
����bibliographic�list,�so�it�need�not�be�calcuated�subsequently.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e112">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">mods:mods</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">enhance</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e114">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">shorten-author</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e116">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">year</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e118">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">year-suffix</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e120">param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">sort-on</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">mods</span>:<span class="xmlverb-element-name"><a name="d29e122">mods</a></span> <span class="xmlverb-attr-name">ID</span>="<span class="xmlverb-attr-content">{@ID}</span>" <span class="xmlverb-attr-name">bib:shorten-author</span>="<span class="xmlverb-attr-content">{$shorten-author}</span>" <span class="xmlverb-attr-name">bib:refclass</span>="<span class="xmlverb-attr-content">{mods:refclass(.)}</span>" <span class="xmlverb-attr-name">bib:reftype</span>="<span class="xmlverb-attr-content">{mods:reftype(.)}</span>" <span class="xmlverb-attr-name">bib:use-reftype</span>="<span class="xmlverb-attr-content">{mods:use_csl-reftype(.)}</span>" <span class="xmlverb-attr-name">bib:sort-on</span>="<span class="xmlverb-attr-content">{$sort-on}</span>" <span class="xmlverb-attr-name">bib:biblist-position</span>="<span class="xmlverb-attr-content">{position()}</span>"&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">bib</span>:<span class="xmlverb-element-name"><a name="d29e124">year</a></span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e126">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$year</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">bib</span>:<span class="xmlverb-element-name">year</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e129">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">$year-suffix</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">bib</span>:<span class="xmlverb-element-name"><a name="d29e131">year-suffix</a></span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e133">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$year-suffix</span>" /&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">bib</span>:<span class="xmlverb-element-name">year-suffix</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e137">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">not(mods:name[mods:role/mods:roleTerm=$primary-contributors])</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">bib</span>:<span class="xmlverb-element-name"><a name="d29e139">noname-substitute</a></span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e141">value-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">mods:grouping-key(.)</span>" /&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">bib</span>:<span class="xmlverb-element-name">noname-substitute</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e145">copy-of</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">*</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;/<span class="xmlverb-element-nsprefix">mods</span>:<span class="xmlverb-element-name">mods</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;!--<span class="xmlverb-comment">�===================================================================�</span>--&gt;<span class="xmlverb-text"><br/>
��</span>&lt;!--<span class="xmlverb-comment">�|����begin�citation�templates�������������������������������������|�</span>--&gt;<span class="xmlverb-text"><br/>
��</span>&lt;!--<span class="xmlverb-comment">�===================================================================�</span>--&gt;<span class="xmlverb-text"><br/>
��</span><div class="xd">
��&lt;<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name"><a name="d29e155">doc</a></span>&gt;<span class="xmlverb-text">Grouping/sorting�author-year�class�citations.</span>&lt;/<span class="xmlverb-element-nsprefix">xdoc</span>:<span class="xmlverb-element-name">doc</span>&gt;</div><span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e158">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">db:citation</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">sort_citation_author-year</span>"&gt;<span class="xmlverb-text"><br/>
����</span>&lt;!--<span class="xmlverb-comment">�store�citation�for�future�use�</span>--&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e162">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">citation</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element()</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e164">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">local-cite-style</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">db:biblioref/@xrefstyle</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()?</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e166">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">idref</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">db:biblioref/@linkend, course:reading/@refid</span>" /&gt;<span class="xmlverb-text"><br/>
����</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e168">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bibref</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$enhanced-biblist/mods:modsCollection/mods:mods[@ID=$idref]</span>" /&gt;<span class="xmlverb-text"><br/>
������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e170">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$bibref</span>" <span class="xmlverb-attr-name">group-by</span>="<span class="xmlverb-attr-content">@bib:sort-on</span>"&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e172">sort</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-grouping-key()</span>" /&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e174">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">refs-for-author-sorted-by-year</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)*</span>"&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e176">perform-sort</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>"&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e178">sort</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">bib:year</span>" /&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">perform-sort</span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e182">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">first-ref-for-author</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$refs-for-author-sorted-by-year[1]</span>" /&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e184">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">last-ref-for-author</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element(mods:mods)</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$refs-for-author-sorted-by-year[position() = last()]</span>" /&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e186">for-each-group</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$refs-for-author-sorted-by-year</span>" <span class="xmlverb-attr-name">group-adjacent</span>="<span class="xmlverb-attr-content">bib:year</span>"&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e188">for-each</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">current-group()</span>"&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e190">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">first-in-author-group</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">. is $first-ref-for-author</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" /&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e192">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">last-in-author-group</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">. is $last-ref-for-author</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" /&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e194">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">id</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">@ID</span>" /&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;!--<span class="xmlverb-comment">�earlier�the�cite-ref�variable�was�defined�as�just�element(),�but<br/>
������������for�some�reason�this�yielded�an�empty-sequence�error�in�one�case�</span>--&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e198">variable</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">cite-ref</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>"&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e200">sequence</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$citation/db:biblioref[@linkend=$id]</span>" /&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">variable</span>&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e203">apply-templates</a></span> <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$style-citation</span>"&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e205">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">first-in-author-group</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$first-in-author-group</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e207">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">last-in-author-group</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$last-in-author-group</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">xs:boolean</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e209">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">local-cite-style</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$local-cite-style</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()?</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e211">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">cite-ref</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">$cite-ref</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">node()</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
��������������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e213">with-param</a></span> <span class="xmlverb-attr-name">name</span>="<span class="xmlverb-attr-content">bib:source</span>" <span class="xmlverb-attr-name">select</span>="<span class="xmlverb-attr-content">.</span>" <span class="xmlverb-attr-name">as</span>="<span class="xmlverb-attr-content">element()</span>" <span class="xmlverb-attr-name">tunnel</span>="<span class="xmlverb-attr-content">yes</span>" /&gt;<span class="xmlverb-text"><br/>
������������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">apply-templates</span>&gt;<span class="xmlverb-text"><br/>
����������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each</span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;!--<span class="xmlverb-comment">�FIX�ME:�config�in�CSL�</span>--&gt;<span class="xmlverb-text"><br/>
��������</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e220">if</a></span> <span class="xmlverb-attr-name">test</span>="<span class="xmlverb-attr-content">position() != last()</span>"&gt;<span class="xmlverb-text">;�</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">if</span>&gt;<span class="xmlverb-text"><br/>
������</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">for-each-group</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
��</span>&lt;<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name"><a name="d29e225">template</a></span> <span class="xmlverb-attr-name">match</span>="<span class="xmlverb-attr-content">db:citation</span>" <span class="xmlverb-attr-name">mode</span>="<span class="xmlverb-attr-content">sort_cited</span>"&gt;<span class="xmlverb-text"><br/>
����XXXX<br/>
��</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">template</span>&gt;<span class="xmlverb-text"><br/>
</span>&lt;/<span class="xmlverb-element-nsprefix">xsl</span>:<span class="xmlverb-element-name">stylesheet</span>&gt;<br/>
</div>
</tt><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>v
         
      
    </div>
    <!--#include virtual="/footer.html" -->
  </body>
</html>
