
<!--#include virtual="/doctype.html" -->
<html>
  <head>
    
    
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="StarOffice 6.0  (Win32)">
	<META NAME="AUTHOR" CONTENT="Frank Sch&ouml;nheit">
	<META NAME="CREATED" CONTENT="20011221;10104626">
	<META NAME="CHANGEDBY" CONTENT="Frank Sch&ouml;nheit">
	<META NAME="CHANGED" CONTENT="20020201;9563417">
	<STYLE>
	<!--
		H3 { color: #000000 }
		H3.western { font-family: "Arial", sans-serif; font-size: 12pt }
		H2 { color: #ffffff }
		H2.western { font-family: "Arial", sans-serif; font-size: 14pt; font-style: italic }
		A:visited { color: #444488 }
		A:link { color: #444488 }
	-->
	</STYLE>

    
    <link href="/css/ooo.css" rel="stylesheet" type="text/css">
    <!--#include virtual="/scripts/google-analytics.js" --> 
    <!--#include virtual="/scripts/entourage.js" -->
  </head>
  <body LANG="en-US" LINK="#444488" VLINK="#444488" BGCOLOR="#eeeeff">
    <!--#include virtual="/brand.html" -->
    <div id="topbara">
      <!--#include virtual="/topnav.html" -->
      <div id="breadcrumbsa"><a href="/">home</a>&nbsp;&raquo;&nbsp;<a href="/ui/">ui</a>&nbsp;&raquo;&nbsp;<a href="/ui/specification/">specification</a></div>
    </div>
    <div id="clear"></div>
      
      
    <div id="content">
      
      
<TABLE WIDTH=100% BORDER=0 CELLPADDING=4 CELLSPACING=0 STYLE="page-break-before: always">
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% BGCOLOR="#666699">
			<H1 ALIGN=CENTER><A HREF="http://www.openoffice.org/"><IMG SRC="../images/open_office_org_logo.gif" NAME="Grafik1" ALT="OpenOffice" ALIGN=RIGHT WIDTH=109 HEIGHT=54 BORDER=0></A><FONT COLOR="#ffffff"><FONT FACE="Arial"><FONT SIZE=5>Feature
			Specification<BR>Product Registration</FONT></FONT></FONT></H1>
		</TD>
	</TR>
</TABLE>
<HR SIZE=3 NOSHADE>
<TABLE WIDTH=100% BORDER=0 CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=5*>
	<COL WIDTH=15*>
	<COL WIDTH=34*>
	<COL WIDTH=202*>
  <TR>
    <TD COLSPAN=4 WIDTH=100%>
      Note: This specification does not apply to OpenOffice.org 2.0. Visit
      <a href="http://specs.openoffice.org">the specification project</a> to find up-to-date product specifications.
    </TD>
  </TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100% BGCOLOR="#666699">
			<H3 CLASS="western" ALIGN=LEFT><FONT COLOR="#ffffff"><FONT SIZE=4>Contents</FONT></FONT></H3>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100%>
			<DL>
				<DT><A HREF="#abstract"><SPAN STYLE="background: transparent">Abstract</SPAN></A></DT></DL>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100%>
			<DL>
				<DT><A HREF="#functional">Functional description</A></DT></DL>
		</TD>
	</TR>
	<TR>
		<TD WIDTH=2%>
			<DL>
				<DT><BR>
				</DT></DL>
		</TD>
		<TD COLSPAN=3 WIDTH=98%>
			<DL>
				<DT><A HREF="#menu">Registration menu item</A></DT></DL>
		</TD>
	</TR>
	<TR>
		<TD WIDTH=2%>
			<DL>
				<DT><BR>
				</DT></DL>
		</TD>
		<TD COLSPAN=3 WIDTH=98%>
			<DL>
				<DT><A HREF="#dialog">Registration Dialog</A></DT></DL>
		</TD>
	</TR>
	<TR>
		<TD WIDTH=2%>
			<DL>
				<DT><BR>
				</DT></DL>
		</TD>
		<TD COLSPAN=3 WIDTH=98%>
			<DL>
				<DT><A HREF="#error">Error Handling</A></DT></DL>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100%>
			<DL>
				<DT><A HREF="#config">Configuration</A></DT></DL>
		</TD>
	</TR>
	<TR>
		<TD WIDTH=2%>
			<DL>
				<DT><BR>
				</DT></DL>
		</TD>
		<TD COLSPAN=3 WIDTH=98%>
			<DL>
				<DT><A HREF="#entries">Configuration Entries</A></DT></DL>
		</TD>
	</TR>
	<TR>
		<TD WIDTH=2%>
			<DL>
				<DT><BR>
				</DT></DL>
		</TD>
		<TD COLSPAN=3 WIDTH=98%>
			<DL>
				<DT><A HREF="#control">Enabling/Disabling the registration
				mechanism</A></DT></DL>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100%>
			<DL>
				<DT><BR>
				</DT></DL>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100% BGCOLOR="#666699">
			<H2 CLASS="western"><A NAME="abstract"></A>Abstract</H2>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100%>
			<P STYLE="margin-bottom: 0.1cm">OpenOffice.org features a
			mechanism for online product registration. Thus, any vendor who
			creates his own, branded version from OpenOffice.org can allow his
			users to register their product copy. This feature is optional,
			and is disabled in the normal OpenOffice.org builds, but can be
			easily enabled by just changing a configuration entry.</P>
			<P STYLE="margin-bottom: 0.1cm">In this context, <I>registration</I>
			means that the user is directed to a web site, provided by the
			vendor, where the real registration takes place.</P>
			<P><BR>
			</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100% BGCOLOR="#666699">
			<H2 CLASS="western"><A NAME="functional"></A>Functional
			description</H2>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100%>
			<P STYLE="margin-bottom: 0.1cm">OpenOffice.org provides mechanisms
			to point the user to a registration web page provided, usually
			by the vendor of the OpenOffice.org based product. For
			browsing to the URL, the system browser is used, the same as is
			invoked when clicking on any link in a OOo document.<BR>The URL
			is a configurable aspect, stored in the configuration.</P>
			<P STYLE="margin-bottom: 0.1cm">There are two different entry
			points for this registration:</P>
			<UL>
				<LI><P STYLE="margin-bottom: 0.1cm">a menu item in the Help menu,
				called &quot;Registration&quot;</P>
				<LI><P STYLE="margin-bottom: 0.1cm">a dialog, which is raised
				after the product has been installed, and asks the user to do the
				registration</P>
			</UL>
			<P>Both entry points can be enabled or disabled independently.</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD COLSPAN=2 WIDTH=92% BGCOLOR="#ccccff">
			<H3 CLASS="western"><A NAME="menu"></A>Registration menu item</H3>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD COLSPAN=2 WIDTH=92%>
			<P>In the help menu, there is an item &quot;Registration...&quot;.
			Upon choosing it, the system browser is invoked with the
			registration URL.</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD COLSPAN=2 WIDTH=92% BGCOLOR="#ccccff">
			<H3 CLASS="western"><A NAME="dialog"></A>Registration dialog</H3>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD COLSPAN=2 WIDTH=92%>
			<UL>
				<LI><P STYLE="margin-bottom: 0.1cm">The registration dialog
				starts when the product is run the <I>n</I>-th time after its
				installation. The number <I>n</I> is configurable, the default is
				2.</P>
				<LI><P STYLE="margin-bottom: 0.1cm">The dialog looks as
				follows:<BR><BR><IMG SRC="../images/registration_dialog.gif" NAME="Graphic1" ALIGN=BOTTOM WIDTH=376 HEIGHT=260 BORDER=0><BR><BR>At
				runtime, every occurrence of &quot;OpenOffice.org&quot; is
				replaced with the real product name, and 1.0 is replaced with the
				concrete product version.</P>
				<LI><P STYLE="margin-bottom: 0.1cm">If the user chooses &quot;Please
				register now&quot;, the registration URL is invoked (same as when
				choosing the &quot;Registration&quot; menu item)</P>
				<LI><P STYLE="margin-bottom: 0.1cm">If the user chooses &quot;Remind
				me to register later&quot;, the dialog vanishes and will reappear
				again after 7 days (at the earliest &ndash; more precise, it
				reappears at the first product start which is at least 7
				days later than the current date).</P>
				<LI><P STYLE="margin-bottom: 0.1cm">If the user chooses &quot;Never
				register&quot;, the dialog disappears and will never reappear
				again.</P>
				<LI><P STYLE="margin-bottom: 0.1cm">If the user chooses &quot;I'm
				already ...&quot;, the dialog disappears and will never reappear
				again.</P>
				<LI><P STYLE="margin-bottom: 0.1cm">If the user cancels the
				dialog, this is interpreted as &quot;Remind me to register
				later&quot;.</P>
			</UL>
			<P><BR>
			</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD COLSPAN=2 WIDTH=92% BGCOLOR="#ccccff">
			<H3 CLASS="western"><A NAME="error"></A>Error Handling</H3>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD COLSPAN=2 WIDTH=92%>
			<P>When calling the external browser to direct the user to the
			online registration page, if an error occurs (maybe because the
			user did not yet configure a system browser), a message
			box pops up suggesting to check the settings of OpenOffice.org, as
			well as the system browser.</P>
			<P>If this error happens when the browser should be invoked from
			the dialog, the dialog won't appear again - the only possibility
			to reach the registration then is the menu item.</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100% BGCOLOR="#666699">
			<H2 CLASS="western"><A NAME="config"></A>Configuration</H2>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100%>
			<P>The registration mechanisms are controlled via configuration
			entries.
			</P>
			<P><BR>
			</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD COLSPAN=2 WIDTH=92% BGCOLOR="#ccccff">
			<H3 CLASS="western"><A NAME="entries"></A>Configuration entries</H3>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD COLSPAN=2 WIDTH=92%>
			<P>The relevant data is stored in the following data nodes to be
			found under <SPAN STYLE="background: transparent"><SPAN STYLE="text-decoration: none"><FONT COLOR="#000000"><I>org.openoffice.Office.Common/Help/Register</I>
			:</FONT></SPAN></SPAN></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD WIDTH=13%>
			<P><I>URL</I></P>
		</TD>
		<TD WIDTH=79%>
			<P>string specifying the URL to be used for online registration</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD WIDTH=13%>
			<P><I>ReminderDate</I></P>
		</TD>
		<TD WIDTH=79%>
			<P>string representation of the date at which the user should be
			reminded (e.g. &quot;13.02.2002&quot;)</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD WIDTH=13%>
			<P><I>RequestDialog</I></P>
		</TD>
		<TD WIDTH=79%>
			<P>number used internally to determine when the dialog should be
			started</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD WIDTH=13%>
			<P><I>ShowMenuItem</I></P>
		</TD>
		<TD WIDTH=79%>
			<P>boolean specifying if the &quot;Registration...&quot; menu item
			is available</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD WIDTH=13%>
			<P><BR>
			</P>
		</TD>
		<TD WIDTH=79%>
			<P><BR>
			</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD COLSPAN=2 WIDTH=92% BGCOLOR="#ccccff">
			<H3 CLASS="western"><A NAME="control"></A>Enabling/Disabling the
			registration mechanism</H3>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=8% BGCOLOR="#ccccff">
			<P><BR>
			</P>
		</TD>
		<TD COLSPAN=2 WIDTH=92%>
			<P STYLE="margin-bottom: 0.1cm; font-style: normal">To enable
			both the registration dialog and the registration menu item, a
			vendor needs to</P>
			<UL>
				<LI><P STYLE="margin-bottom: 0.1cm; font-style: normal">provide a
				URL to the registration web page and store it in the <I>URL</I>
				node</P>
				<LI><P STYLE="margin-bottom: 0.1cm; font-style: normal">set the
				<I>ReminderDate</I> to an empty string</P>
				<LI><P STYLE="margin-bottom: 0.1cm; font-style: normal">set the
				<I>RequestDialog</I> value to <I>1</I> (or <I>2</I> for the
				dialog to appear at the second start.)</P>
				<LI><P STYLE="margin-bottom: 0.1cm; font-style: normal">set the
				<I>ShowMenuItem</I> value to <I>true</I></P>
			</UL>
			<P STYLE="margin-bottom: 0.1cm; font-style: normal"><BR>To disable
			the menu item only, the <I>ShowMenuItem</I> should be set to
			<I>false</I>.</P>
			<P STYLE="margin-bottom: 0.1cm; font-style: normal">To disable the
			dialog only, the <I>RequestDialog</I> should be set to <I>0</I>.</P>
			<P STYLE="margin-bottom: 0.1cm; font-style: normal">To disable
			both features at once, the <I>URL</I> should be set to an empty
			string. This overrules the before-mentioned settings,
			since without an URL the features do not make sense.</P>
			<P><BR>
			</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100%>
			<P><BR>
			</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100%>
			<HR SIZE=1 NOSHADE>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100% BGCOLOR="#666699">
			<P ALIGN=LEFT><FONT COLOR="#ffffff">Author: </FONT><A HREF="mailto:fs@openoffice.org"><SPAN STYLE="background: transparent"><FONT COLOR="#ffffff">Frank
			Sch&ouml;nheit</FONT></SPAN></A><A HREF="mailto:ibo@system-entwicklung.de"><FONT COLOR="#444488"><BR></FONT></A><FONT COLOR="#ffffff">Last
			Modified: $Date: 2005/11/03 07:49:28 $<BR><I>Copyright &copy; 2001
			OpenOffice.org</I></FONT></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=4 WIDTH=100%>
			<HR SIZE=1 NOSHADE>
		</TD>
	</TR>
</TABLE>
<HR SIZE=3 NOSHADE>

      
    </div>
    <!--#include virtual="/footer.html" -->
  </body>
</html>
